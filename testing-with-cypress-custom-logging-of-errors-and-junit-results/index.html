<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><script src="/scripts.js"></script><!-- Font preloads --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/testing-with-cypress-custom-logging-of-errors-and-junit-results/"><!-- Primary Meta Tags --><title>Testing with Cypress - Custom logging of errors and JUnit results</title><meta name="title" content="Testing with Cypress - Custom logging of errors and JUnit results"><meta name="description" content="Description of the custom error logger and also custom JUnit XML file creator."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/testing-with-cypress-custom-logging-of-errors-and-junit-results/"><meta property="og:title" content="Testing with Cypress - Custom logging of errors and JUnit results"><meta property="og:description" content="Description of the custom error logger and also custom JUnit XML file creator."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/testing-with-cypress-custom-logging-of-errors-and-junit-results/"><meta property="twitter:title" content="Testing with Cypress - Custom logging of errors and JUnit results"><meta property="twitter:description" content="Description of the custom error logger and also custom JUnit XML file creator."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}pre{margin:0;padding:12px}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}.tab{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab button{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab button:hover{background-color:#ddd}.tab button.active{background-color:#ccc}.tabcontent{display:none;border-top:none}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}.tags[data-astro-cid-bvzihdzo]{display:flex;flex-wrap:wrap}.tags[data-astro-cid-bvzihdzo]>a[data-astro-cid-bvzihdzo]{margin-left:8px}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 class="post-title" data-astro-cid-bvzihdzo>Testing with Cypress - Custom logging of errors and JUnit results</h1> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2019-06-29T00:00:00.000Z"> Jun 29, 2019 </time> </div> <hr data-astro-cid-bvzihdzo> </div>  <p><span>This post is part of a Cypress series, you can see all post from the series in </span><a href="/testing-with-cypress-lessons-learned-in-a-complete-framework/">Testing with Cypress – lessons learned in a complete framework</a><span>. Examples code is located </span><span>in </span><a href="https://github.com/llatinov/cypress-testing-framework" target="_blank" rel="noopener noreferrer">cypress-testing-framework</a><span> GitHub repository.</span></p>
<h2>The issue</h2>
Cypress is not good at error tracking and reporting. If a test fails it is hard to understand why. Errors sometimes are vague, stacktrace is not useful as it does not lead to the proper line of your code since it is being wrapped into Cypress' code. Forget about the nice stack traces that Java/C# code is producing, where you just go, find, and eliminate the error without even debugging. Debugging errors in tests is much harder with Cypress.
<h2>The solution</h2>
Gleb Bahmutov, currently a VP of Engineering at Cypress.io has a nice NPM package, called <a href="https://www.npmjs.com/package/cypress-failed-log" target="_blank" rel="noopener noreferrer">cypress-failed-log</a>. It gathers commands that Cypress was executing during a test run and in case of a failure saves them to a file. You can inspect the file and trace what parts of your test were executed.
<h2>Modified solution</h2>
I started with that solution but did not enjoy it much. What I did is to take the base code and modify it. Those modifications are still tracking the Cypress commands, but also they track requests and response being exchanged by application and the backend, so in case of error you can also inspect the backend response. One important thing is that each test should have a unique name, otherwise overlapping may occur. The logging code is located in <em><strong>cypress/support/core/cypress_logging.js</strong></em> file, it is registered to Cypress within <em><strong>cypress/support/index.js</strong></em> file with <em><strong>import './core/cypress_logging';</strong></em>. The code also copies the screenshot of the test failure for better understanding of the error.
<p>Capturing of request/response between the backend and the frontend can be controlled with <em><strong>TEST_CAPTURE_RESPONSES</strong></em> environment variable, it is <em><strong>true</strong></em> by default. Sometimes you will need to avoid certain requests/responses from being captured as they are not important. This can be done with <em><strong>TEST_CAPTURE_RESPONSES_EXCLUDE_PATHS</strong></em> variable, use asterisks to match the URLs. For e.g. I am testing a Ruby on Rails application which has a profiler enabled, which massively pollutes the logs, so I exclude those with <em><strong>‘<em>/mini-profiler-resources/</em>’</strong></em> pattern.</p>
<p>All this data is saved as a file with the name of the test inside a folder with the name of the suite. For e.g. <em><strong>cypress/logs/logging/multiple_testsuites_mix_spec.js/Test suite mix #1 — test case #2 (failed).json</strong></em>. The name of the JSON file is same as the name of the automatically generated screenshot on failure.</p>
<h2>JUnit results with Cypress</h2>
In order to make Cypress output the test results into <em><strong>JUnit XML</strong></em> file following steps has to be done. Add the following configuration into cypress.json. This configuration makes Cypress create JUnit XML file. The important bit here is <em><strong>[hash]</strong></em> in the file name, otherwise, Cypress will overwrite the files.
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>{</span></span>
<span class="line"><span>    "reporter": "junit",</span></span>
<span class="line"><span>    "reporterOptions": {</span></span>
<span class="line"><span>        "mochaFile": "results/my-test-output-[hash].xml"</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>If you use some CI tool then you can pass the XML results to it and it will visualize them.</p>
<p>Additionally, you can manipulate the XML results, you can merge them into just one XML file by installing <a href="https://www.npmjs.com/package/junit-merge" target="_blank" rel="noopener noreferrer">junit-merge</a> as a global NPM package and run <em><strong>junit-merge -d results -o results/merged.xml</strong></em>.</p>
<p>You can generate an HTML from XMLs with <a href="https://www.npmjs.com/package/xunit-viewer" target="_blank" rel="noopener noreferrer">xunit-viewer</a> NPM package. In case you have merged the XMLs into one then the command is <em><strong>xunit-viewer —results=results/merged.xml —output=results/merged.html</strong></em>, in case you have not the command is <em><strong>xunit-viewer —results=results —output=results/merged.html</strong></em>.</p>
<h2>Custom JUnit results</h2>
Well, the out of the box solution is good but not enough for me. It does not show the skipped tests, it adds one more <em><strong>testsuite</strong></em> with name Root Suite, which is empty and Jenkins for e.g. avoids it, but if you want to visualize the results into HTML then it is a problem. What I have done is to generate JUnit XML on my own. This happens automatically in <em><strong>cypress_logging.js</strong></em> file. Files are put into the <em><strong>cypress/logs</strong></em> folder and have the name of the suite. Processing of the custom results is additionally made in provided code, you can read mode in <a href="/testing-with-cypress-code-coverage-with-istanbul/">Testing with Cypress - Code with Istanbul</a> post.
<h2>Compare of JUnit reports</h2>
In this section, I will put some comparison of Cypress JUnit results and the one I have created. See the images below how HTML report looks like. HTML files can be opened from <a href="/examples/Cypress-JUnit/Cypress-report.html" target="_blank" rel="noopener noreferrer">Cypress-report.html</a> and <a href="/examples/Cypress-JUnit/Custom-report.html" target="_blank" rel="noopener noreferrer">Custom-report.html</a>. XML results can be downloaded from <a href="/examples/Cypress-JUnit/xmls.zip" target="_blank" rel="noopener noreferrer">xmls.zip</a>.
<p><strong>Cypress standard HTML report</strong></p>
<p><a href="/images/2019/06/Cypress-HTML-strandard.png"><img src="/images/2019/06/Cypress-HTML-strandard.png"></a></p>
<p><strong>Cypress custom HTML report</strong></p>
<p><a href="/images/2019/06/Cypress-HTML-custom.png"><img src="/images/2019/06/Cypress-HTML-custom.png"></a></p>
<p>I also made a quick Jenkins installation from its Docker container and uploaded the results for comparison. Below are the images of the comparison. Both JUnit reports are not visualized very well. Mostly this is because of the fact that JUnit is a format for Java tests, where we have packages and Jenkins is visualizing the results based on this assumption.</p>
<p><strong>Cypress Jenkins standard</strong></p>
<p><a href="/images/2019/06/Cypress-Jenkins-standard.png"><img src="/images/2019/06/Cypress-Jenkins-standard.png"></a></p>
<p><strong>Cypress Jenkins custom</strong></p>
<p><a href="/images/2019/06/Cypress-Jenkins-custom.png"><img src="/images/2019/06/Cypress-Jenkins-custom.png"></a></p>
<h2>HTML Reports</h2>
HTML report is generated with xunit-viewer NPM package as described above. It is done by invoking the <strong><em>yarn</em> cypress:report</strong> command. Above you can also see how HTML report looks like.
<h2>Semaphore file</h2>
Apart from the HTML report, there is one more file that is generated. It is named <em><strong>failed.txt</strong></em>. We are using AWS CodeBuild for CI/CD and we just need an indicator if the build passed or not. If this file is present then the build failed. The file content shows which are the failed suites. The whole artifacts are zipped and uploaded to an S3 bucket where can be investigated later.
<h2>Conclusion</h2>
In the current post, I have described the custom functionality I have for improving the debugging of failed tests by logging more information. Also, I have made a custom JUnit reporting of the test results. An HTML report is generated for better visualization of the results.  <hr data-astro-cid-bvzihdzo>  <h2 data-astro-cid-bvzihdzo>Related Posts</h2> <ul data-astro-cid-bvzihdzo> <li data-astro-cid-bvzihdzo> <a href="/testing-with-cypress-lessons-learned-in-a-complete-framework/" data-astro-cid-bvzihdzo>Testing with Cypress - lessons learned in a complete framework</a> </li> </ul>  <div class="tags" data-astro-cid-bvzihdzo> <div data-astro-cid-bvzihdzo>Tags:</div> <a href="/tags/cypress" data-astro-cid-bvzihdzo>Cypress</a><a href="/tags/javascript" data-astro-cid-bvzihdzo>JavaScript</a><a href="/tags/junit" data-astro-cid-bvzihdzo>JUnit</a><a href="/tags/tutorials" data-astro-cid-bvzihdzo>Tutorials</a><a href="/tags/web-automation" data-astro-cid-bvzihdzo>Web Automation</a> </div> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>