<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><!-- Font preloads --><!-- <link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin /> --><!-- <link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin /> --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/implement-secure-rest-api-authentication-http/"><!-- Primary Meta Tags --><title>How to implement secure REST API authentication over HTTP</title><meta name="title" content="How to implement secure REST API authentication over HTTP"><meta name="description" content="How to implement secure API authentication even over HTTP."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/implement-secure-rest-api-authentication-http/"><meta property="og:title" content="How to implement secure REST API authentication over HTTP"><meta property="og:description" content="How to implement secure API authentication even over HTTP."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/implement-secure-rest-api-authentication-http/"><meta property="twitter:title" content="How to implement secure REST API authentication over HTTP"><meta property="twitter:description" content="How to implement secure API authentication even over HTTP."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder-1.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2016-07-07T00:00:00.000Z"> Jul 7, 2016 </time> <div class="last-updated-on" data-astro-cid-bvzihdzo>
Last updated on <time datetime="2022-01-18T00:00:00.000Z"> Jan 18, 2022 </time> </div> </div> <h1 class="post-title" data-astro-cid-bvzihdzo>How to implement secure REST API authentication over HTTP</h1> <hr data-astro-cid-bvzihdzo> </div>  <p><strong>Important:</strong> this post is not a complete and expert guide on API security. It is mainly done to test Postman Pre-request hook that is described in <a href="/introduction-postman-examples/">Introduction to Postman with examples</a> post. It does not go into all the details about API security, SSL certificates, encrypting the data, etc. It gives basic information how you can protect your API’s consumers against their network traffic being sniffed and credentials, apiKeys, session keys, etc stolen.</p>
<h2>Authentication vs. Authorisation</h2>
Authentication is defined as <em><strong>"Who you are"</strong></em>. It deals with usernames and password. The authorization is defined as <em><strong>"What you can do"</strong></em>. It deals with permissions. Before dealing with permissions application must know the user, so Authorisation comes after Authentication.
<h2>Basic Authentication</h2>
As it is stated it is very basic. The idea is to send a Base64 encoded username and password in the header of the request in the following format:
<pre class="language-text"><code>Authorization: Basic dXNlcjpwYXNz
</code></pre>
<p>Server decodes the username and password and uses them to authenticate and authorize the user. Problem with Basic authentication is it must be used only over HTTPS since network traffic is encrypted. Over HTTP request can be easily sniffed. Base64 is reversible and there are numerous tools on the web where you can put <em><strong>dXNlcjpwYXNz</strong></em> and they will return <em><strong>user:pass</strong></em> as plain text.</p>
<p><strong>Nota bene:</strong> Never use this one without HTTPS.</p>
<h2>OAuth and OAuth 2.0</h2>
OAuth is authorization protocol. It is intended mainly for web but can be used in API authorization. The idea is that authentication and authorization are done by a third party like Microsoft, Google, Facebook, Twitter, etc. This is easy for API as it does not have to deal with user data. Customer logins to the third party and then access token is being issued. Token has some validity which is not too long, but not too short, usually 1 or 2 days. The API can obtain user details from the third party by this token. The user authenticates itself to the API with this access token by sending it in the request header:
<pre class="language-text"><code>Authorization: Bearer 66408bd9-2bc0-40c3-9823-e9bec390532a
</code></pre>
<p>Problem with OAuth is it also must be used over HTTPS. Over HTTP traffic can be sniffed and the token can be stolen. Although token has some expiry time, it is long enough for a hacker to use API on your behalf.</p>
<p><strong>Nota bene:</strong> Never use this one without HTTPS.</p>
<h2>API keys</h2>
API keys have become the standard when consuming an API. API key is some random hash which uniquely identifies the consumer. API keys have numerous benefits over username/password mechanism. Again in case of HTTP network traffic can be sniffed and API key can be stolen.
<h2>HTTPS</h2>
Reading post so far turned out there is not a single API authentication protocol that is secure if not used over HTTPS. In the current post, a solution is proposed. It is commonly used in public APIs, it is possible to exist as a standard I'm just not aware of its name, which provides secure API authentication even over HTTP.
<h2>Implement API security over HTTP</h2>
In short, in order to have security over HTTP following steps should be done:
<ul>
 	<li>The secret key that is known only by API consumer and API provider is needed along with API key.</li>
 	<li>The secret key is used to one way hash a token which is sent to the server along with API key in the API call.</li>
 	<li>Token consists of API key + Secret key + Current time in seconds, which then gets hashed with SHA-256 algorithm preferably.</li>
 	<li>Server recreates all the tokens locally for every second for some time in the future, preferably not too long - 30~120 seconds.</li>
 	<li>Server recreates all the tokens for 30~120 seconds in the past, to take into account the time needed for the request to reach the server.</li>
 	<li>The server compares each of the tokens with received one.</li>
 	<li>If there is match consumer is authenticated and a response is returned.</li>
</ul>
<h2>Cryptographic hash algorithms</h2>
Most used hash algorithms nowadays are MD5, SHA-1, SHA-256, SHA-512. MD5 and SHA-1 are to week and are not recommended. SHA-512 takes more time to compute the hashes. SHA-256 is the most appropriate solution in terms of security and speed. In <a href="/md5-sha-1-sha-256-sha-512-speed-performance/">MD5, SHA-1, SHA-256 and SHA-512 speed performance</a> post all 4 algorithms have been tested and compared with Apache's Commons Codec implementation.
<h2>Hash with Salt</h2>
Timestamp into hashed token is used for so-called salt, a random data that is used to differentiate the hashed data against dictionary attacks. If just API key + Secret key are hashed, then the hash will always be one and the same. An intruder will take the hash and just use it. Using timestamp makes the hash always different. Another function of the time stamp is to set an expiration time on the token, so even if stolen not to be used for a long period of time.
<h2>Conclusion</h2>
There are already established standards to secure an API, but all of them are effective only over HTTPS. In the current post is given a proposal for secure API authentication which is very simple and relatively safe even over HTTP. Cons of this method are server has to recalculate hash many times, which in massive load would require some caching. In <a href="/implement-secure-api-authentication-http-dropwizard/">Implement secure API authentication over HTTP with Dropwizard</a> post, there is a reference implementation of a proposed solution with Dropwizard.  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>