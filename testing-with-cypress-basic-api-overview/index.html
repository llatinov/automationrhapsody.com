<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><script src="/scripts.js"></script><!-- Font preloads --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/testing-with-cypress-basic-api-overview/"><!-- Primary Meta Tags --><title>Testing with Cypress - Basic API overview</title><meta name="title" content="Testing with Cypress - Basic API overview"><meta name="description" content="Basic overview of the Cypress API with code samples for some of the interesting features."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/testing-with-cypress-basic-api-overview/"><meta property="og:title" content="Testing with Cypress - Basic API overview"><meta property="og:description" content="Basic overview of the Cypress API with code samples for some of the interesting features."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/testing-with-cypress-basic-api-overview/"><meta property="twitter:title" content="Testing with Cypress - Basic API overview"><meta property="twitter:description" content="Basic overview of the Cypress API with code samples for some of the interesting features."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:100%;margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}pre{margin:0;padding:12px}.card{padding:16px;margin:10px;box-shadow:0 2px 3px #acabab;background:#fff;border-radius:24px;color:inherit}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}.tab{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab button{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab button:hover{background-color:#ddd}.tab button.active{background-color:#ccc}.tabcontent{display:none;border-top:none}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}.tags[data-astro-cid-bvzihdzo]{display:flex;flex-wrap:wrap}.tags[data-astro-cid-bvzihdzo]>a[data-astro-cid-bvzihdzo]{margin-left:8px}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article class="card" data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 class="post-title" data-astro-cid-bvzihdzo>Testing with Cypress - Basic API overview</h1> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2019-06-29T00:00:00.000Z"> Jun 29, 2019 </time> </div> <hr data-astro-cid-bvzihdzo> </div>  <p>This post is part of a Cypress series, you can see all post from the series in <a href="/testing-with-cypress-lessons-learned-in-a-complete-framework/">Testing with Cypress - lessons learned in a complete framework</a>. Examples code is located <span>in </span><a href="https://github.com/llatinov/cypress-testing-framework" target="_blank" rel="noopener noreferrer">cypress-testing-framework</a><span> GitHub repository.</span></p>
<h2>Cypress API</h2>
Cypress is so much different than Selenium, so it takes some time to get used to the way elements are located and interacted with. I am not going into details about the API here but will mention some basic things. Methods in the API are kind of self-explanatory, mainly used ones are: <em><strong>get</strong></em>, <em><strong>find</strong></em>, <em><strong>click</strong></em>, <em><strong>type</strong></em>, <em><strong>first</strong></em>, <em><strong>last</strong></em>, <em><strong>prev</strong></em>, <em><strong>next</strong></em>, <em><strong>children</strong></em>, <em><strong>parent</strong></em>, etc.
<p>Cypress uses jQuery selectors to locate elements, so you can have things like <em><strong>contains</strong></em>, <em><strong>nth-child</strong></em>, <em><strong>.class</strong></em>, <em><strong>#id</strong></em>, <em><strong>[name*=”value”]</strong></em> (and all variations). A very interesting and sometimes useful feature is that you can make Cypress click hidden elements with <em><strong>click({force: true})</strong></em>, Cypress gives you an error that element is not clickable from a user point of view, and you can choose to find another element or just force the click. Also, you can click multiple elements with <em><strong>click({multiple: true})</strong></em>.</p>
<h2>Explore Cypress API</h2>
When every project is created for the first time, Cypress installs examples for all their APIs. Those are very good and extensive. I have preserved their examples in the current project and they are available in <em><strong>cypress/examples</strong></em> folder. You can run all the examples with <em><strong>yarn cypress:examples:run</strong></em> command. You can explore them one by one in the <em><strong>Test Runner</strong></em>, which can be opened with <em><strong>yarn cypress:examples:open</strong></em> command.
<h2>Page Object Model</h2>
As mentioned in the main topic, Cypress recommends using custom commands instead of Page Objects. I do not like this idea, so I use page objects, as I believe they make the code more focused. Here is an example of a page object I am conformable with:
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>export default class AboutPage {</span></span>
<span class="line"><span>  constructor() {</span></span>
<span class="line"><span>    this.elements = {</span></span>
<span class="line"><span>      navigation: () => cy.getSilent('a[href$=about]'),</span></span>
<span class="line"><span>      paragraph: index => cy.getSilent('section.m-3 div p').eq(index),</span></span>
<span class="line"><span>    };</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  goTo() {</span></span>
<span class="line"><span>    cy.visit('/');</span></span>
<span class="line"><span>    this.elements.navigation().click();</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  /**</span></span>
<span class="line"><span>   * @param {string} version</span></span>
<span class="line"><span>   * @param {Date} datetime</span></span>
<span class="line"><span>   */</span></span>
<span class="line"><span>  verifyPage(version, datetime) {</span></span>
<span class="line"><span>    this.elements.paragraph(0)</span></span>
<span class="line"><span>      .should('text', 'Welcome to the about page.');</span></span>
<span class="line"><span>    this.elements.paragraph(1)</span></span>
<span class="line"><span>      .should('text', `Current API version is: ${version}`);</span></span>
<span class="line"><span>    this.elements.paragraph(2)</span></span>
<span class="line"><span>      .should('text', `Current time is: ${datetime.toISOString()}`);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<h2>Clock</h2>
Cypress allows you to modify the clock in the browser. For e.g. About page of the application under test shows the current time. It makes much more easy to validate the visualization in case you control the current time. Otherwise, you have to parse the time and put some thresholds in the verifications.
<h2>Stub response</h2>
Another very handy feature is to be able to stub the response that API is supposed to return. In this way, you can very easily test for situations like timeout, incorrect response, error in response, etc.
<h2>Clock and Stub example</h2>
I have combined clock and stubbing into one example. The test suite file is cypress/tests/stub/response_and_clock_spec.js. The <em><strong>cy.clock(datetime.getTime());</strong></em> sets the date to one you need. The <em><strong>cy.route('GET', '/api/version', version);</strong></em> simulates that API returns the version as a response. In the current case, it is a plain string, but in general case, this s JSON object.
<div class="tab"><button id="4503-response_and_clock_spec.js" class="tablinks active" onclick="openTab(this, &#x27;content-4503-response_and_clock_spec.js&#x27;, &#x27;4503&#x27;)">response_and_clock_spec.js</button>
<button id="4503-about_page.js" class="tablinks" onclick="openTab(this, &#x27;content-4503-about_page.js&#x27;, &#x27;4503&#x27;)">about_page.js</button></div>
<div id="content-4503-response_and_clock_spec.js" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>import AboutPage from '../../pages/about_page';</span></span>
<span class="line"><span></span></span>
<span class="line"><span>describe('Check about page', () => {</span></span>
<span class="line"><span>  it('should show correct stubbed data and clock', () => {</span></span>
<span class="line"><span>    const aboutPage = new AboutPage();</span></span>
<span class="line"><span>    const version = '2.33';</span></span>
<span class="line"><span>    const datetime = new Date('2014-07-22T15:24:00');</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    cy.server();</span></span>
<span class="line"><span>    cy.route('GET', '/api/version', version);</span></span>
<span class="line"><span>    cy.clock(datetime.getTime());</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    aboutPage.goTo();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    aboutPage.verifyPage(version, datetime);</span></span>
<span class="line"><span>  });</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-4503-about_page.js" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>  verifyPage(version, datetime) {</span></span>
<span class="line"><span>    this.elements.paragraph(0)</span></span>
<span class="line"><span>      .should('text', 'Welcome to the about page.');</span></span>
<span class="line"><span>    this.elements.paragraph(1)</span></span>
<span class="line"><span>      .should('text', `Current API version is: ${version}`);</span></span>
<span class="line"><span>    this.elements.paragraph(2)</span></span>
<span class="line"><span>      .should('text', `Current time is: ${datetime.toISOString()}`);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h2>Running custom Node.js code</h2>
Cypress runs into the browser, this is its biggest strength as you have direct access to your application and the browser. This is its weakness as well because the browser is much restrictive in terms of running code. In order to run custom Node.js code, you have to wrap it as a task. The Cypress task accepts only one argument, so if you need to pass more, you have to wrap them in a JSON object. The task should also return a promise. Tasks are registered into <em><strong>cypress/plugins/index.js</strong></em> file. See examples below. Task <em><strong>copyFile</strong></em> is used in <em><strong>cypress_loggin.js</strong></em>, a parameter that is passed to it is a JSON object with <em><strong>from</strong></em> and <em><strong>to</strong></em> keys. This task is registered with Cypress in <em><strong>index.js</strong></em>. Implementation is done in <em><strong>tasks.js</strong></em> where actual Node.js code is used to manipulate the file system and a <em><strong>Promise</strong></em> is returned.
<div class="tab"><button id="6554-cypress_logging.js" class="tablinks active" onclick="openTab(this, &#x27;content-6554-cypress_logging.js&#x27;, &#x27;6554&#x27;)">cypress_logging.js</button>
<button id="6554-index.js" class="tablinks" onclick="openTab(this, &#x27;content-6554-index.js&#x27;, &#x27;6554&#x27;)">index.js</button>
<button id="6554-tasks.js" class="tablinks" onclick="openTab(this, &#x27;content-6554-tasks.js&#x27;, &#x27;6554&#x27;)">tasks.js</button></div>
<div id="content-6554-cypress_logging.js" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>cy.task('copyFile', {</span></span>
<span class="line"><span>  from: `cypress/screenshots/${screenshotFilename}`,</span></span>
<span class="line"><span>  to: getFilePath(screenshotFilename),</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-6554-index.js" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>const tasks = require('./tasks');</span></span>
<span class="line"><span></span></span>
<span class="line"><span>module.exports = (on, config) => {</span></span>
<span class="line"><span>  // `on` is used to hook into various events Cypress emits</span></span>
<span class="line"><span>  on('task', {</span></span>
<span class="line"><span>    copyFile: tasks.copyFile,</span></span>
<span class="line"><span>  });</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // `config` is the resolved Cypress config</span></span>
<span class="line"><span>  const newConfig = config;</span></span>
<span class="line"><span>  newConfig.watchForFileChanges = false;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return newConfig;</span></span>
<span class="line"><span>};</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-6554-tasks.js" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>const fs = require('fs');</span></span>
<span class="line"><span></span></span>
<span class="line"><span>const copyFile = args =></span></span>
<span class="line"><span>  new Promise(resolve => {</span></span>
<span class="line"><span>    if (fs.existsSync(args.from)) {</span></span>
<span class="line"><span>      fs.writeFileSync(args.to, fs.readFileSync(args.from));</span></span>
<span class="line"><span>      resolve(`File ${args.from} copied to ${args.to}`);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>    resolve(`File ${args.from} does not exist`);</span></span>
<span class="line"><span>  });</span></span>
<span class="line"><span></span></span>
<span class="line"><span>module.exports = { copyFile };</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h2>Working with promises</h2>
Cypress is based on <a href="https://developers.google.com/web/fundamentals/primers/promises" target="_blank" rel="noopener noreferrer">promises</a>. Each Cypress command returns a command which is similar to a promise, but actually is different, read mode in <a href="https://docs.cypress.io/guides/core-concepts/introduction-to-cypress.html#Commands-Are-Not-Promises" target="_blank" rel="noopener noreferrer">Commands Are Not Promises</a>. If you want to access the value from the previous operation you have to unwrap it with a <em><strong>then()</strong></em> method. If you have several dependencies then this nesting becomes bigger and bigger. This is why I have adopted some code from <a href="https://medium.com/@NicholasBoll/cypress-io-using-async-and-await-4034e9bab207" target="_blank" rel="noopener noreferrer">Nicholas Boll</a> to avoid nesting. The article above is about using <em><strong>async/await</strong></em> but actually, it is not going to work with my custom logging, I will write in the next section. Initially, I started using directly the plugin from Nicholas, but I have observed strange bugs where a test fails but is not reported as such, so I modified it and it is proved stable now.
<p>See examples below. The standard way of doing it is by unwrapping the command with the <em><strong>then()</strong></em> method. This is working but can get really ugly if you have too many nested unwrappings. The option is to use <em><strong>promisify()</strong></em> which wraps the Cypress command into a promise. The promise is then resolved only inside some other Cypress command, such as <em><strong>cy.log()</strong></em> or custom command <em><strong>cy.apiGetPerson()</strong></em>. If you print it directly the result in the <em><strong>console</strong></em> is a <em><strong>Promise</strong></em>.</p>
<div class="tab"><button id="9496-with unwrap" class="tablinks active" onclick="openTab(this, &#x27;content-9496-with unwrap&#x27;, &#x27;9496&#x27;)">with unwrap</button>
<button id="9496-with promisify()" class="tablinks" onclick="openTab(this, &#x27;content-9496-with promisify()&#x27;, &#x27;9496&#x27;)">with promisify()</button>
<button id="9496-cypress_promisify.js" class="tablinks" onclick="openTab(this, &#x27;content-9496-cypress_promisify.js&#x27;, &#x27;9496&#x27;)">cypress_promisify.js</button></div>
<div id="content-9496-with unwrap" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>it('should work with regular unwrap', () => {</span></span>
<span class="line"><span>  const person = new Person();</span></span>
<span class="line"><span>  // This is a command</span></span>
<span class="line"><span>  cy.apiSavePerson(person).then(personId => {</span></span>
<span class="line"><span>    // Value is unwrapped and printed properly</span></span>
<span class="line"><span>    cy.log(personId);</span></span>
<span class="line"><span>    console.log(personId);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Value is passed unwrapped</span></span>
<span class="line"><span>    cy.apiGetPerson(personId).then(res => cy.log(res));</span></span>
<span class="line"><span>  });</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-9496-with promisify()" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>it('should work with promisify', () => {</span></span>
<span class="line"><span>  const person = new Person();</span></span>
<span class="line"><span>  // This is a promise</span></span>
<span class="line"><span>  const personId = cy.apiSavePerson(person).promisify();</span></span>
<span class="line"><span>  // Cypress internally resolves the promise</span></span>
<span class="line"><span>  cy.log(personId);</span></span>
<span class="line"><span>  // Prints a Promise</span></span>
<span class="line"><span>  console.log(personId);</span></span>
<span class="line"><span>  // Value is accessible after unwrap</span></span>
<span class="line"><span>  personId.then(pid => console.log(pid));</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Cypress internally unwraps the value</span></span>
<span class="line"><span>  cy.apiGetPerson(personId).then(res => cy.log(res));</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-9496-cypress_promisify.js" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>function promisify(chain) {</span></span>
<span class="line"><span>  return new Cypress.Promise((resolve, reject) => {</span></span>
<span class="line"><span>    chain.then(resolve);</span></span>
<span class="line"><span>  });</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>before(function() {</span></span>
<span class="line"><span>  cy.wrap('').__proto__.promisify = function() {</span></span>
<span class="line"><span>    return promisify(this);</span></span>
<span class="line"><span>  };</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h2>Working with async/await</h2>
The code above should work with <a href="https://javascript.info/async-await" target="_blank" rel="noopener noreferrer">async/await</a>, which is an amazing JavaScript feature. It does work but it messes up with the custom logging I have described into <a href="/testing-with-cypress-custom-logging-of-errors-and-junit-results/">Testing with Cypress - Custom logging of errors and JUnit results</a> post. The code below works, but the custom logging is not triggered. So I would say, do not use async/await if you need those customizations. The bigger issue is that async/await does not seem to work in Electron, <em><strong>cy.apiGetPerson()</strong></em> is actually not invoked if you run the code in Electron browser.
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>it('should work with async/await', async () => {</span></span>
<span class="line"><span>  const person = new Person();</span></span>
<span class="line"><span>  // This is a resolved promise</span></span>
<span class="line"><span>  const personId = await cy.apiSavePerson(person).promisify();</span></span>
<span class="line"><span>  // Value is wrapped and printed properly</span></span>
<span class="line"><span>  cy.log(personId);</span></span>
<span class="line"><span>  console.log(personId);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Value is passed unwrapped</span></span>
<span class="line"><span>  cy.apiGetPerson(personId).then(res => cy.log(res));</span></span>
<span class="line"><span>});</span></span>
<span class="line"><span></span></span></code></pre>
<h2>Full API documentation</h2>
Cypress has very good and extensive documentation, you can read more at <a href="https://docs.cypress.io/api/api/table-of-contents.html" target="_blank" rel="noopener noreferrer">Cypress API</a> article.
<h2>Conclusion</h2>
Cypress has a rich API which requires some time investments to get used to. You have good things like controlling the clock of the browser, controlling the API response from the backend. Good thing is that you have a way to run whatever code you want in your tests, but it has to wrapped as a task, otherwise you cannot just run any code in the browser.  <hr data-astro-cid-bvzihdzo>  <h2 data-astro-cid-bvzihdzo>Related Posts</h2> <ul data-astro-cid-bvzihdzo> <li data-astro-cid-bvzihdzo> <a href="/testing-with-cypress-lessons-learned-in-a-complete-framework/" data-astro-cid-bvzihdzo>Testing with Cypress - lessons learned in a complete framework</a> </li><li data-astro-cid-bvzihdzo> <a href="/testing-with-cypress-custom-logging-of-errors-and-junit-results/" data-astro-cid-bvzihdzo>Testing with Cypress - Custom logging of errors and JUnit results</a> </li> </ul>  <div class="tags" data-astro-cid-bvzihdzo> <div data-astro-cid-bvzihdzo>Tags:</div> <a href="/tags/cypress" data-astro-cid-bvzihdzo>Cypress</a><a href="/tags/javascript" data-astro-cid-bvzihdzo>JavaScript</a><a href="/tags/web-automation" data-astro-cid-bvzihdzo>Web Automation</a> </div> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>