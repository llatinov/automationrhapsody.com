<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><script src="/scripts.js"></script><!-- Font preloads --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/java-8-features-stream-api-advanced-examples/"><!-- Primary Meta Tags --><title>Java 8 features - Stream API advanced examples</title><meta name="title" content="Java 8 features - Stream API advanced examples"><meta name="description" content="This post explains Java 8 Stream API with very basic code examples."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/java-8-features-stream-api-advanced-examples/"><meta property="og:title" content="Java 8 features - Stream API advanced examples"><meta property="og:description" content="This post explains Java 8 Stream API with very basic code examples."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/java-8-features-stream-api-advanced-examples/"><meta property="twitter:title" content="Java 8 features - Stream API advanced examples"><meta property="twitter:description" content="This post explains Java 8 Stream API with very basic code examples."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:100%;margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}pre{margin:0;padding:12px}.card{padding:16px;margin:10px;box-shadow:0 2px 3px #acabab;background:#fff;border-radius:24px;color:inherit}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}.tab{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab button{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab button:hover{background-color:#ddd}.tab button.active{background-color:#ccc}.tabcontent{display:none;border-top:none}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}.tags[data-astro-cid-bvzihdzo]{display:flex;flex-wrap:wrap}.tags[data-astro-cid-bvzihdzo]>a[data-astro-cid-bvzihdzo]{margin-left:8px}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article class="card" data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 class="post-title" data-astro-cid-bvzihdzo>Java 8 features - Stream API advanced examples</h1> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2017-06-23T00:00:00.000Z"> Jun 23, 2017 </time> </div> <hr data-astro-cid-bvzihdzo> </div>  <p>In <a href="/java-8-features-lambda-expressions-interface-changes-stream-api-datetime-api/">Java 8 features – Lambda expressions, Interface changes, Stream API, DateTime API</a> post I have briefly described most interesting Java 8 features. In the current post, I will give special attention to Stream API. This post is with more advanced code examples to elaborate on basic examples described in <a href="/java-8-features-stream-api-basic-examples/">Java 8 features – Stream API basic examples</a> post. Code examples here can be found in GitHub <a href="https://github.com/llatinov/java-samples/tree/master/java8" target="_blank" rel="noopener">java-samples/java8</a> repository.</p>
<h2>Memory consumption and better design</h2>
Stream API has operations that are short-circuiting, such as <em><strong>limit()</strong></em>. Once their goal is achieved they stop processing the stream. Most of the operators are not such. Here I have prepared an example for possible pitfall when using not short-circuiting operators. For testing purposes, I have created PeekObject which outputs a message to the console once its constructor is called.
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public class PeekObject {</span></span>
<span class="line"><span>    private String message;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public PeekObject(String message) {</span></span>
<span class="line"><span>        this.message = message;</span></span>
<span class="line"><span>        System.out.println("Constructor called for: " + message);</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public String getMessage() {</span></span>
<span class="line"><span>        return message;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>Assume a situation where there is a stream of many instances of PeekObject, but only several elements of the stream are needed, thus they have to be limited. Only 2 constructors are called in this case.</p>
<div class="tab"><button id="1802-limit the stream" class="tablinks active" onclick="openTab(this, &#x27;content-1802-limit the stream&#x27;, &#x27;1802&#x27;)">limit the stream</button>
<button id="1802-unit test" class="tablinks" onclick="openTab(this, &#x27;content-1802-unit test&#x27;, &#x27;1802&#x27;)">unit test</button>
<button id="1802-console output" class="tablinks" onclick="openTab(this, &#x27;content-1802-console output&#x27;, &#x27;1802&#x27;)">console output</button></div>
<div id="content-1802-limit the stream" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static List&#x3C;PeekObject> limit_shortCircuiting(List&#x3C;String> stringList,</span></span>
<span class="line"><span>                            int limit) {</span></span>
<span class="line"><span>    return stringList.stream()</span></span>
<span class="line"><span>        .map(PeekObject::new)</span></span>
<span class="line"><span>        .limit(limit)</span></span>
<span class="line"><span>        .collect(Collectors.toList());</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-1802-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_limit_shortCircuiting() {</span></span>
<span class="line"><span>    System.out.println("limit_shortCircuiting");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;String> stringList = Arrays.asList("a", "b", "a", "c", "d", "a");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;PeekObject> result = AdvancedStreamExamples</span></span>
<span class="line"><span>        .limit_shortCircuiting(stringList, 2);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(result.size(), is(2));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-1802-console output" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>limit_shortCircuiting</span></span>
<span class="line"><span>Constructor called for: a</span></span>
<span class="line"><span>Constructor called for: b</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<p>Now stream has to be sorted before the limit is applied.</p>
<div class="tab"><button id="2816-code" class="tablinks active" onclick="openTab(this, &#x27;content-2816-code&#x27;, &#x27;2816&#x27;)">code</button>
<button id="2816-unit test" class="tablinks" onclick="openTab(this, &#x27;content-2816-unit test&#x27;, &#x27;2816&#x27;)">unit test</button>
<button id="2816-console output" class="tablinks" onclick="openTab(this, &#x27;content-2816-console output&#x27;, &#x27;2816&#x27;)">console output</button></div>
<div id="content-2816-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static List&#x3C;PeekObject> sorted_notShortCircuiting(</span></span>
<span class="line"><span>                    List&#x3C;String> stringList, int limit) {</span></span>
<span class="line"><span>    return stringList.stream()</span></span>
<span class="line"><span>        .map(PeekObject::new)</span></span>
<span class="line"><span>        .sorted((left, right) -> </span></span>
<span class="line"><span>            left.getMessage().compareTo(right.getMessage()))</span></span>
<span class="line"><span>        .limit(limit)</span></span>
<span class="line"><span>        .collect(Collectors.toList());</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-2816-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_sorted_notShortCircuiting() {</span></span>
<span class="line"><span>    System.out.println("sorted_notShortCircuiting");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;String> stringList = Arrays.asList("a", "b", "a", "c", "d", "a");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;PeekObject> result = AdvancedStreamExamples</span></span>
<span class="line"><span>        .sorted_notShortCircuiting(stringList, 2);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(result.size(), is(2));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-2816-console output" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>sorted_notShortCircuiting</span></span>
<span class="line"><span>Constructor called for: a</span></span>
<span class="line"><span>Constructor called for: b</span></span>
<span class="line"><span>Constructor called for: a</span></span>
<span class="line"><span>Constructor called for: c</span></span>
<span class="line"><span>Constructor called for: d</span></span>
<span class="line"><span>Constructor called for: a</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<p>Notice that constructors for all objects in the stream are called. This will require Java to allocate enough memory for all the objects. There are 6 objects in this example, but what if there are 6 million. Also, current objects are very lightweight, but what if they are much bigger. The conclusion is that you have to know very well Stream API operations and apply them carefully when designing your stream pipeline.</p>
<h2>Convert comma separated List to a Map with handling duplicates</h2>
There is a <strong><em>List</em></strong> of comma separated values which need to be converted to a <em><strong>Map</strong></em>. List value <em><strong>"11,21"</strong></em> should become Map entry with key <em><strong>11</strong></em> and value <em><strong>21</strong></em>. Duplicated keys also should be considered: <em><strong>Arrays.asList("11,21", "12,21", "13,23", "13,24")</strong></em>.
<div class="tab"><button id="4864-code" class="tablinks active" onclick="openTab(this, &#x27;content-4864-code&#x27;, &#x27;4864&#x27;)">code</button>
<button id="4864-unit test" class="tablinks" onclick="openTab(this, &#x27;content-4864-unit test&#x27;, &#x27;4864&#x27;)">unit test</button></div>
<div id="content-4864-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static Map&#x3C;Long, Long> splitToMap(List&#x3C;String> stringsList) {</span></span>
<span class="line"><span>    return stringsList.stream()</span></span>
<span class="line"><span>        .filter(StringUtils::isNotEmpty)</span></span>
<span class="line"><span>        .map(line -> line.split(","))</span></span>
<span class="line"><span>        .filter(array -> array.length == 2 </span></span>
<span class="line"><span>            &#x26;&#x26; NumberUtils.isNumber(array[0])</span></span>
<span class="line"><span>            &#x26;&#x26; NumberUtils.isNumber(array[1]))</span></span>
<span class="line"><span>        .collect(Collectors.toMap(array -> Long.valueOf(array[0]), </span></span>
<span class="line"><span>            array -> Long.valueOf(array[1]), (first, second) -> first)));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-4864-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_splitToMap() {</span></span>
<span class="line"><span>    List&#x3C;String> stringList = Arrays</span></span>
<span class="line"><span>            .asList("11,21", "12,21", "13,23", "13,24");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Map&#x3C;Long, Long> result = AdvancedStreamExamples.splitToMap(stringList);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(result.size(), is(3));</span></span>
<span class="line"><span>    assertThat(result.get(11L), is(21L));</span></span>
<span class="line"><span>    assertThat(result.get(12L), is(21L));</span></span>
<span class="line"><span>    assertThat(result.get(13L), is(23L));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<p>The important bit in this conversion is <em><strong>(first, second) -> first)</strong></em>, if it is not present there will be error <em><strong>java.lang.IllegalStateException: Duplicate key 23</strong></em> (slightly misleading error, as the duplicated key is 13, the value is 23). This is a merge function which resolves collisions between values associated with the same key. It evaluates two values found for the same key - first and second where current lambda returns the first. If overwrite is needed, hence keep the last entered value then lambda would be: <em><strong>(first, second) -> second)</strong></em>.</p>
<h2>Examples of custom object</h2>
Examples to follow use custom object Employee, where Position is an enumeration: <em><strong>public enum Position { DEV, DEV_OPS, QA }</strong></em>.
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>import java.util.List;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>public class Employee {</span></span>
<span class="line"><span>    private String firstName;</span></span>
<span class="line"><span>    private String lastName;</span></span>
<span class="line"><span>    private Position position;</span></span>
<span class="line"><span>    private List&#x3C;String> skills;</span></span>
<span class="line"><span>    private int salary;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public Employee() {</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public Employee(String firstName, String lastName,</span></span>
<span class="line"><span>                Position position, int salary) {</span></span>
<span class="line"><span>        this.firstName = firstName;</span></span>
<span class="line"><span>        this.lastName = lastName;</span></span>
<span class="line"><span>        this.position = position;</span></span>
<span class="line"><span>        this.salary = salary;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public void setSkills(String... skills) {</span></span>
<span class="line"><span>        this.skills = Arrays.stream(skills).collect(Collectors.toList());</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    public String getName() {</span></span>
<span class="line"><span>        return this.firstName + " " + this.lastName;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    ... Getters and Setters</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>A company has been created, it consists of 6 developers, 2 QAs and 2 DevOps..</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>private List&#x3C;Employee> createCompany() {</span></span>
<span class="line"><span>    Employee dev1 = new Employee("John", "Doe", Position.DEV, 110);</span></span>
<span class="line"><span>    dev1.setSkills("C#", "ASP.NET", "React", "AngularJS");</span></span>
<span class="line"><span>    Employee dev2 = new Employee("Peter", "Doe", Position.DEV, 120);</span></span>
<span class="line"><span>    dev2.setSkills("Java", "MongoDB", "Dropwizard", "Chef");</span></span>
<span class="line"><span>    Employee dev3 = new Employee("John", "Smith", Position.DEV, 115);</span></span>
<span class="line"><span>    dev3.setSkills("Java", "JSP", "GlassFish", "MySql");</span></span>
<span class="line"><span>    Employee dev4 = new Employee("Brad", "Johston", Position.DEV, 100);</span></span>
<span class="line"><span>    dev4.setSkills("C#", "MSSQL", "Entity Framework");</span></span>
<span class="line"><span>    Employee dev5 = new Employee("Philip", "Branson", Position.DEV, 140);</span></span>
<span class="line"><span>    dev5.setSkills("JavaScript", "React", "AngularJS", "NodeJS");</span></span>
<span class="line"><span>    Employee dev6 = new Employee("Nathaniel", "Barth", Position.DEV, 99);</span></span>
<span class="line"><span>    dev6.setSkills("Java", "Dropwizard");</span></span>
<span class="line"><span>    Employee qa1 = new Employee("Ronald", "Wynn", Position.QA, 100);</span></span>
<span class="line"><span>    qa1.setSkills("Selenium", "C#", "Java");</span></span>
<span class="line"><span>    Employee qa2 = new Employee("Erich", "Kohn", Position.QA, 105);</span></span>
<span class="line"><span>    qa2.setSkills("Selenium", "JavaScript", "Protractor");</span></span>
<span class="line"><span>    Employee devOps1 = new Employee("Harold", "Jess", Position.DEV_OPS, 116);</span></span>
<span class="line"><span>    devOps1.setSkills("CentOS", "bash", "c", "puppet", "chef", "Ansible");</span></span>
<span class="line"><span>    Employee devOps2 = new Employee("Karl", "Madsen", Position.DEV_OPS, 123);</span></span>
<span class="line"><span>    devOps2.setSkills("Ubuntu", "bash", "Python", "chef");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    return Arrays.asList(dev1, dev2, dev3, dev4, dev5, dev6,</span></span>
<span class="line"><span>                qa1, qa2, devOps1, devOps2);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<h3>Company skill set</h3>
This method accepts none, one or many positions. If no positions are provided then information for all positions is printed. Positions array is transferred to <em><strong>List&#x3C;String></strong></em> because all objects used in lambda should be effectively final. Transferring array to stream is done with <em><strong>Arrays.stream()</strong></em> method. Employees are filtered based on the desired position. Each skills list is concatenated and flattened to a stream with <em><strong>flatMap()</strong></em>. After this operation, there is a stream of strings with all skills. Duplicates are removed with <em><strong>distinct()</strong></em>. Finally, stream is collected to a list.
<div class="tab"><button id="10284-code" class="tablinks active" onclick="openTab(this, &#x27;content-10284-code&#x27;, &#x27;10284&#x27;)">code</button>
<button id="10284-unit test" class="tablinks" onclick="openTab(this, &#x27;content-10284-unit test&#x27;, &#x27;10284&#x27;)">unit test</button></div>
<div id="content-10284-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static List&#x3C;String> gatherEmployeeSkills(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees, Position... positions) {</span></span>
<span class="line"><span>    positions = positions == null || positions.length == 0 </span></span>
<span class="line"><span>        ? Position.values() : positions;</span></span>
<span class="line"><span>    List&#x3C;Position> searchPositions = Arrays.stream(positions)</span></span>
<span class="line"><span>            .collect(Collectors.toList());</span></span>
<span class="line"><span>    return employees == null ? Collections.emptyList()</span></span>
<span class="line"><span>        : employees.stream()</span></span>
<span class="line"><span>            .filter(employee </span></span>
<span class="line"><span>                -> searchPositions.contains(employee.getPosition()))</span></span>
<span class="line"><span>            .flatMap(employee -> employee.getSkills().stream())</span></span>
<span class="line"><span>            .distinct()</span></span>
<span class="line"><span>            .collect(Collectors.toList());</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-10284-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_gatherEmployeeSkills() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;String> skills = AdvancedStreamExamples</span></span>
<span class="line"><span>            .gatherEmployeeSkills(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(skills.size(), is(25));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Skillset per position</h3>
This method first received a list of all skills per position and converts it to a stream. The stream can be collected to a <em><strong>String</strong></em> with <em><strong>Collectors.joining()</strong></em> method. It accepts delimiter, prefix, and suffix.
<div class="tab"><button id="11562-code" class="tablinks active" onclick="openTab(this, &#x27;content-11562-code&#x27;, &#x27;11562&#x27;)">code</button>
<button id="11562-unit test" class="tablinks" onclick="openTab(this, &#x27;content-11562-unit test&#x27;, &#x27;11562&#x27;)">unit test</button></div>
<div id="content-11562-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static String printEmployeeSkills(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees, Position position) {</span></span>
<span class="line"><span>    List&#x3C;String> skills = gatherEmployeeSkills(employees, position);</span></span>
<span class="line"><span>    return skills.stream()</span></span>
<span class="line"><span>        .collect(Collectors.joining("; ",</span></span>
<span class="line"><span>            "Our " + position + "s have: ", " skills"));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-11562-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_printEmployeeSkills() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    String skills = AdvancedStreamExamples</span></span>
<span class="line"><span>            .printEmployeeSkills(company, Position.QA);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(skills, is("Our employees have: "</span></span>
<span class="line"><span>        + "Selenium; C#; Java; JavaScript; Protractor skills"));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Salary statistics</h3>
This method returns <em><strong>Map</strong></em> with <em><strong>Positio</strong></em>n as key and <em><strong>IntSummaryStatistics</strong></em> as value. <em><strong>Collectors.groupingBy()</strong></em> groups employees by position key and then using <em><strong>Collectors.summarizingInt()</strong></em> to get statistics of employee's salary.
<div class="tab"><button id="12759-code" class="tablinks active" onclick="openTab(this, &#x27;content-12759-code&#x27;, &#x27;12759&#x27;)">code</button>
<button id="12759-unit test" class="tablinks" onclick="openTab(this, &#x27;content-12759-unit test&#x27;, &#x27;12759&#x27;)">unit test</button></div>
<div id="content-12759-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static Map&#x3C;Position, IntSummaryStatistics> salaryStatistics(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees) {</span></span>
<span class="line"><span>    return employees.stream()</span></span>
<span class="line"><span>        .collect(Collectors.groupingBy(Employee::getPosition,</span></span>
<span class="line"><span>            Collectors.summarizingInt(Employee::getSalary)));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-12759-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_salaryStatistics() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Map&#x3C;Position, IntSummaryStatistics> salaries = AdvancedStreamExamples</span></span>
<span class="line"><span>            .salaryStatistics(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(salaries.get(Position.DEV).getAverage(), is(114D));</span></span>
<span class="line"><span>    assertThat(salaries.get(Position.QA).getAverage(), is(102.5D));</span></span>
<span class="line"><span>    assertThat(salaries.get(Position.DEV_OPS).getAverage(), is(119.5D));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Position with the lowest average salary</h3>
Map with position and salary summary is retrieved and then with <em><strong>entrySet().stream()</strong></em> map is converted to stream of <em><strong>Entry&#x3C;Position, IntSummaryStatistics></strong></em> objects. Entries are sorted by average value in ascending order by custom comparator <em><strong>Double.compare()</strong></em>. <em><strong>findFirst()</strong></em> returns <em><strong>Optional&#x3C;Entry></strong></em>. The entry itself is obtained with <em><strong>get()</strong></em> method. The key which is basically the position is obtained with <em><strong>getKey()</strong></em> method.
<div class="tab"><button id="14257-code" class="tablinks active" onclick="openTab(this, &#x27;content-14257-code&#x27;, &#x27;14257&#x27;)">code</button>
<button id="14257-unit test" class="tablinks" onclick="openTab(this, &#x27;content-14257-unit test&#x27;, &#x27;14257&#x27;)">unit test</button></div>
<div id="content-14257-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static Position positionWithLowestAverageSalary(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees) {</span></span>
<span class="line"><span>    return salaryStatistics(employees)</span></span>
<span class="line"><span>        .entrySet().stream()</span></span>
<span class="line"><span>        .sorted((entry1, entry2) </span></span>
<span class="line"><span>            -> Double.compare(entry1.getValue().getAverage(),</span></span>
<span class="line"><span>                entry2.getValue().getAverage()))</span></span>
<span class="line"><span>        .findFirst()</span></span>
<span class="line"><span>        .get()</span></span>
<span class="line"><span>        .getKey();</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-14257-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_positionWithLowestAverageSalary() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Position position = AdvancedStreamExamples</span></span>
<span class="line"><span>            .positionWithLowestAverageSalary(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(position, is(Position.QA));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Employees per each position</h3>
Grouping is done per position and employees are aggregated to list with <em><strong>Collectors.toList()</strong></em> method.
<div class="tab"><button id="15165-code" class="tablinks active" onclick="openTab(this, &#x27;content-15165-code&#x27;, &#x27;15165&#x27;)">code</button>
<button id="15165-unit test" class="tablinks" onclick="openTab(this, &#x27;content-15165-unit test&#x27;, &#x27;15165&#x27;)">unit test</button></div>
<div id="content-15165-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static Map&#x3C;Position, List&#x3C;Employee>> employeesPerPosition(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees) {</span></span>
<span class="line"><span>    return employees.stream()</span></span>
<span class="line"><span>        .collect(Collectors.groupingBy(Employee::getPosition,</span></span>
<span class="line"><span>                Collectors.toList()));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-15165-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_employeesPerPosition() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Map&#x3C;Position, List&#x3C;Employee>> employees = AdvancedStreamExamples</span></span>
<span class="line"><span>            .employeesPerPosition(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA).size(), is(2));</span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA).get(0).getName(),</span></span>
<span class="line"><span>        is("Ronald Wynn"));</span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA).get(1).getName(),</span></span>
<span class="line"><span>        is("Erich Kohn"));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Employee names per each position</h3>
Similar to the method above, but one more mapping is needed here. Employee name should be extracted and converted to <em><strong>List&#x3C;String></strong></em>. This is done with <em><strong>Collectors.mapping(Employee::getName, Collectors.toList())</strong></em> method.
<div class="tab"><button id="16344-code" class="tablinks active" onclick="openTab(this, &#x27;content-16344-code&#x27;, &#x27;16344&#x27;)">code</button>
<button id="16344-unit test" class="tablinks" onclick="openTab(this, &#x27;content-16344-unit test&#x27;, &#x27;16344&#x27;)">unit test</button></div>
<div id="content-16344-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static Map&#x3C;Position, List&#x3C;String>> employeeNamesPerPosition(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees) {</span></span>
<span class="line"><span>    return employees.stream()</span></span>
<span class="line"><span>        .collect(Collectors.groupingBy(Employee::getPosition,</span></span>
<span class="line"><span>            Collectors.mapping(Employee::getName,</span></span>
<span class="line"><span>                        Collectors.toList())));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-16344-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_employeeNamesPerPosition() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Map&#x3C;Position, List&#x3C;String>> employees = AdvancedStreamExamples</span></span>
<span class="line"><span>            .employeeNamesPerPosition(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA).size(), is(2));</span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA).get(0), is("Ronald Wynn"));</span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA).get(1), is("Erich Kohn"));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Employee count per position</h3>
Getting the count is done by <em><strong>Collectors.counting()</strong></em> method. It returns <em><strong>Long</strong></em> by default. If <em><strong>Integer</strong></em> is needed then this can be changed to <em><strong>Collectors.reducing(0, e -> 1, Integer::sum)</strong></em>.
<div class="tab"><button id="17560-code" class="tablinks active" onclick="openTab(this, &#x27;content-17560-code&#x27;, &#x27;17560&#x27;)">code</button>
<button id="17560-unit test" class="tablinks" onclick="openTab(this, &#x27;content-17560-unit test&#x27;, &#x27;17560&#x27;)">unit test</button></div>
<div id="content-17560-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static Map&#x3C;Position, Long> employeesCountPerPosition(</span></span>
<span class="line"><span>            List&#x3C;Employee> employees) {</span></span>
<span class="line"><span>    return employees.stream()</span></span>
<span class="line"><span>        .collect(Collectors.groupingBy(Employee::getPosition,</span></span>
<span class="line"><span>                        Collectors.counting()));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-17560-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_employeesCountPerPosition() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Map&#x3C;Position, Long> employees = AdvancedStreamExamples</span></span>
<span class="line"><span>                .employeesCountPerPosition(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(employees.get(Position.DEV), is(6L));</span></span>
<span class="line"><span>    assertThat(employees.get(Position.QA), is(2L));</span></span>
<span class="line"><span>    assertThat(employees.get(Position.DEV_OPS), is(2L));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h3>Employees with duplicated first name</h3>
Employees are grouped into a map with key first name and <em><strong>List&#x3C;Employee></strong></em> as value. This map is converted to stream and filtered for <em><strong>List&#x3C;Employee></strong></em> greater than 1 element. The list is flattened with <em><strong>flatMap()</strong></em> and collected to <em><strong>List&#x3C;Employee></strong></em>.
<div class="tab"><button id="18739-code" class="tablinks active" onclick="openTab(this, &#x27;content-18739-code&#x27;, &#x27;18739&#x27;)">code</button>
<button id="18739-unit test" class="tablinks" onclick="openTab(this, &#x27;content-18739-unit test&#x27;, &#x27;18739&#x27;)">unit test</button></div>
<div id="content-18739-code" class="tabcontent" style="display: block">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>public static List&#x3C;Employee> employeesWithDuplicateFirstName(</span></span>
<span class="line"><span>        List&#x3C;Employee> employees) {</span></span>
<span class="line"><span>    return employees.stream()</span></span>
<span class="line"><span>        .collect(Collectors.groupingBy(Employee::getFirstName,</span></span>
<span class="line"><span>                        Collectors.toList()))</span></span>
<span class="line"><span>        .entrySet().stream()</span></span>
<span class="line"><span>        .filter(entry -> entry.getValue().size() > 1)</span></span>
<span class="line"><span>        .flatMap(entry -> entry.getValue().stream())</span></span>
<span class="line"><span>        .collect(Collectors.toList());</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<div id="content-18739-unit test" class="tabcontent">
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Test</span></span>
<span class="line"><span>public void test_employeesWithDuplicateFirstName() {</span></span>
<span class="line"><span>    List&#x3C;Employee> company = createCompany();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;Employee> employees = AdvancedStreamExamples</span></span>
<span class="line"><span>            .employeesWithDuplicateFirstName(company);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    assertThat(employees.size(), is(2));</span></span>
<span class="line"><span>    assertThat(employees.get(0).getName(), is("John Doe"));</span></span>
<span class="line"><span>    assertThat(employees.get(1).getName(), is("John Smith"));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
</div>
<h2>Conclusion</h2>
In this post, I have just scratched the Java 8 Stream API. It offers a vast amount of functionalities which can be very useful for data processing. Beware when generating stream pipeline because it might end up consuming too many resources.  <hr data-astro-cid-bvzihdzo>  <h2 data-astro-cid-bvzihdzo>Related Posts</h2> <ul data-astro-cid-bvzihdzo> <li data-astro-cid-bvzihdzo> <a href="/java-8-features-lambda-expressions-interface-changes-stream-api-datetime-api/" data-astro-cid-bvzihdzo>Java 8 features - Lambda expressions, Interface changes, Stream API, DateTime API</a> </li><li data-astro-cid-bvzihdzo> <a href="/java-8-features-stream-api-explained/" data-astro-cid-bvzihdzo>Java 8 features - Stream API explained</a> </li><li data-astro-cid-bvzihdzo> <a href="/java-8-features-stream-api-basic-examples/" data-astro-cid-bvzihdzo>Java 8 features - Stream API basic examples</a> </li> </ul>  <div class="tags" data-astro-cid-bvzihdzo> <div data-astro-cid-bvzihdzo>Tags:</div> <a href="/tags/java" data-astro-cid-bvzihdzo>Java</a><a href="/tags/java8" data-astro-cid-bvzihdzo>Java 8</a><a href="/tags/tutorials" data-astro-cid-bvzihdzo>Tutorials</a> </div> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>