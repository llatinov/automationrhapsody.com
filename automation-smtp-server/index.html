<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><script src="/scripts.js"></script><!-- Font preloads --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/automation-smtp-server/"><!-- Primary Meta Tags --><title>Automation SMTP Server</title><meta name="title" content="Automation SMTP Server"><meta name="description" content="Automation SMTP Server is simple SMTP server run as console application."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/automation-smtp-server/"><meta property="og:title" content="Automation SMTP Server"><meta property="og:description" content="Automation SMTP Server is simple SMTP server run as console application."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/automation-smtp-server/"><meta property="twitter:title" content="Automation SMTP Server"><meta property="twitter:description" content="Automation SMTP Server is simple SMTP server run as console application."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}pre{margin:0;padding:12px}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}.tab{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab button{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab button:hover{background-color:#ddd}.tab button.active{background-color:#ccc}.tabcontent{display:none;border-top:none}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}.tags[data-astro-cid-bvzihdzo]{display:flex;flex-wrap:wrap}.tags[data-astro-cid-bvzihdzo]>a[data-astro-cid-bvzihdzo]{margin-left:8px}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 class="post-title" data-astro-cid-bvzihdzo>Automation SMTP Server</h1> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2015-03-16T00:00:00.000Z"> Mar 16, 2015 </time> </div> <hr data-astro-cid-bvzihdzo> </div>  <h2>About</h2>
<p>Automation SMTP Server is simple SMTP server run as console application. It acts as SMTP server saving all email messages as EML file to disk. With build in EMLFile class you can later read those emails and verify them in your automation testing project.</p>
<p>More info can be found in <a title="Complete guide to email verifications with Automation SMTP Server" href="/complete-guide-to-email-verifications/">Complete guide to email verifications with Automation SMTP Server</a> post.</p>
<h2>Download</h2>
<p>SMTP server can be found as EXE with its CONFIG file in <a title="GitHub" href="https://github.com/llatinov/AutomationSMTPServer/releases" target="_blank">GitHub releases</a>.</p>
<h2>Configuration</h2>
<ul>
	<li>Port - Automation SMTP Server have a config file in which port on which server listens can be configured. Port also can be passed as argument when running it from command prompt. It port is not provided in one of both ways 25 is taken by default.</li>
	<li>Emails directory - emails are saved in folder named "temp" in same directory where Automation SMTP Server EXE is. This cannot be changed.</li>
</ul>
<h2>Usage</h2>
<ol>
<li>From your automation test project add reference to AutomationSMTPServer.exe.</li>
<li>Delete previous emails</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>private string currentDir =</span></span>
<span class="line"><span>    Directory.GetCurrentDirectory() + Path.DirectorySeparatorChar;</span></span>
<span class="line"><span>private string mailsDir = currentDir + "temp";</span></span>
<span class="line"><span></span></span>
<span class="line"><span>if (Directory.Exists(mailsDir))</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    Directory.Delete(mailsDir, true);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<ol start="3">
<li>Start Automation SMTP Server as process</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Process smtpServer = new Process();</span></span>
<span class="line"><span>smtpServer.StartInfo.FileName = currentDir + "AutomationSMTPServer.exe";</span></span>
<span class="line"><span>smtpServer.StartInfo.Arguments = "25";</span></span>
<span class="line"><span>smtpServer.Start();</span></span>
<span class="line"><span></span></span></code></pre>
<ol start="4">
<li>Read emails</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>string[] files = Directory.GetFiles(mailsDir);</span></span>
<span class="line"><span>List&#x3C;EMLFile> mails = new List&#x3C;EMLFile>();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>foreach (string file in files)</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    EMLFile mail = new EMLFile(file);</span></span>
<span class="line"><span>    mails.Add(mail);</span></span>
<span class="line"><span>    File.Delete(file);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<ol start="5">
<li>Do desired verifications with EMLFile objects</li>
<li>Stop Automation SMTP Server by killing the process</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>smtpServer.Kill();</span></span>
<span class="line"><span></span></span></code></pre>  <hr data-astro-cid-bvzihdzo>  <div class="tags" data-astro-cid-bvzihdzo> <div data-astro-cid-bvzihdzo>Tags:</div> <a href="/tags/ntestsrunner" data-astro-cid-bvzihdzo>SMTP/EMail</a><a href="/tags/tutorials" data-astro-cid-bvzihdzo>Tutorials</a> </div> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>