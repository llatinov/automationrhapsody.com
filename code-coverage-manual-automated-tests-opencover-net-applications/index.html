<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><script src="/scripts.js"></script><!-- Font preloads --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/code-coverage-manual-automated-tests-opencover-net-applications/"><!-- Primary Meta Tags --><title>Code coverage of manual or automated tests with OpenCover for .NET applications</title><meta name="title" content="Code coverage of manual or automated tests with OpenCover for .NET applications"><meta name="description" content="Examples how to do code coverage of manual or automated functional test with OpenCover tool for .NET applications"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/code-coverage-manual-automated-tests-opencover-net-applications/"><meta property="og:title" content="Code coverage of manual or automated tests with OpenCover for .NET applications"><meta property="og:description" content="Examples how to do code coverage of manual or automated functional test with OpenCover tool for .NET applications"><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/code-coverage-manual-automated-tests-opencover-net-applications/"><meta property="twitter:title" content="Code coverage of manual or automated tests with OpenCover for .NET applications"><meta property="twitter:description" content="Examples how to do code coverage of manual or automated functional test with OpenCover tool for .NET applications"><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}pre{margin:0;padding:12px}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}.tab{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab button{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab button:hover{background-color:#ddd}.tab button.active{background-color:#ccc}.tabcontent{display:none;border-top:none}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}.tags[data-astro-cid-bvzihdzo]{display:flex;flex-wrap:wrap}.tags[data-astro-cid-bvzihdzo]>a[data-astro-cid-bvzihdzo]{margin-left:8px}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 class="post-title" data-astro-cid-bvzihdzo>Code coverage of manual or automated tests with OpenCover for .NET applications</h1> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2016-06-01T00:00:00.000Z"> Jun 1, 2016 </time> </div> <hr data-astro-cid-bvzihdzo> </div>  <h2>Code coverage</h2>
This topic is how to do the code coverage on .NET applications with OpenCover. Theory on what is code coverage, why it is needed can be found in <a href="/what-about-code-coverage/">What about code coverage</a> post.
<h2>OpenCover</h2>
<a href="https://github.com/OpenCover/opencover" target="_blank" rel="noopener noreferrer">OpenCover</a> is open source tool for code coverage for .NET 2.0 and above applications for Windows only. With OpenCover instrumentation of the code is not needed. The application is started through OpenCover and it collects coverage results. What is mandatory though is <a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/ms241903(v=vs.90)" target="_blank" rel="noopener noreferrer">PDB file</a> along with executables and assemblies, so application under test should be built in Debug mode. If PDB file is not found then no coverage data will be gathered.
<p>The latest version can be downloaded form <em><strong>Releases</strong></em> in GitHub. There are installer and zip archive. If the installer is used by default <em><strong>OpenCover</strong></em> is installed in <em><strong>C:\Users{USER_ACCOUNT}\AppData\Local\Apps\OpenCover</strong></em>. If you want to change this, click <em><strong>Advanced</strong></em> button during installation and then select <strong><em>Install for all users on this</em> <span style="text-decoration: underline;">m</span>achine</strong>.</p>
<h2>How to use OpenCover</h2>
Usage guide can be found in <a href="https://github.com/opencover/opencover/wiki/Usage" target="_blank" rel="noopener noreferrer">OpenCover usage reference</a> online. Also along with OpenCover installation, there is Usage.rft file which holds all the information about the tool. Most useful commands are listed below:
<ul>
 	<li><em><strong>-target:&#x3C;path to target></strong></em> - the path to application executable file or name of service</li>
 	<li><em><strong>-filter:&#x3C;filters></strong></em> - list of filters to apply to selectively include or exclude assemblies and classes from coverage results</li>
 	<li><em><strong>-output:&#x3C;output file></strong></em> - the path to output XML file, if empty then results.xml will be created the in the current directory</li>
 	<li><em><strong>-register[:user]</strong></em> - register and de-register the code coverage profiler</li>
 	<li><em><strong>-targetargs:&#x3C;target arguments></strong></em> - arguments to be passed to the target process</li>
 	<li><em><strong>-targetdir:&#x3C;target directory></strong></em> - path to the target directory or alternative path to PDB files</li>
</ul>
<h2>ReportGenerator</h2>
OpenCover produces results in raw format, which is not for humans. <a href="https://danielpalme.github.io/ReportGenerator/" target="_blank" rel="noopener noreferrer">ReportGenerator</a> is used to convert <em><strong>XML</strong></em> reports generated by <em><strong>OpenCover</strong></em>, <em><strong>PartCover</strong></em>, <em><strong>Visual Studio</strong></em> or <em><strong>NCover</strong></em> into human readable reports in various formats. Usage guide can be found on its home page, most useful commands are:
<ul>
 	<li><em><strong>-reports:&#x3C;report></strong></em> - coverage reports that should be parsed, semicolon separated, wildcards are allowed</li>
 	<li><em><strong>-targetdir:&#x3C;target directory></strong></em> - directory where the generated report should be saved</li>
 	<li><em><strong>-sourcedirs:&#x3C;directory>[;&#x3C;directory>][;&#x3C;directory>]</strong></em> - directories which contain the corresponding source code, optional, semicolon separated</li>
 	<li><em><strong>-classfilters:&#x3C;(+|-)filter>[;&#x3C;(+|-)filter>][;&#x3C;(+|-)filter>]</strong></em> - list of classes that should be included or excluded in the report, optional, wildcards are allowed.</li>
</ul>
<h2>Hands on examples on manual code coverage</h2>
In order to try you need to checkout code samples from GitHub <a title="SampleAppPlus" href="https://github.com/llatinov/SampleApp" target="_blank" rel="noopener noreferrer">SampleApp</a> or <a title="SampleAppPlus" href="https://github.com/llatinov/SampleAppPlus" target="_blank" rel="noopener noreferrer">SampleAppPlus</a> repository to <em><strong>C:\</strong></em>. <em><strong>Telerik Testing Framework</strong></em> needs to be installed as it copies lots of assemblies in <em><strong>GAC</strong></em>. <em><strong>OpenCover</strong></em> and <em><strong>ReportGenerator</strong></em> should also be installed to <em><strong>C:\</strong></em>.
<p>With current setup command to start SimpleAppPlus.exe from OpenCover is:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>C:\OpenCover\OpenCover.Console.exe `</span></span>
<span class="line"><span>    -target:"C:\SampleAppPlus\SampleAppPlus\bin\Debug\SampleAppPlus.exe" `</span></span>
<span class="line"><span>    -output:C:\SampleAppPlus\CoverageReports\SampelAppPlus.results.xml `</span></span>
<span class="line"><span>    -register:user</span></span>
<span class="line"><span></span></span></code></pre>
<p>Now the application is started and manual functional tests can be executed. Once the application is stopped coverage results are saved in SampelAppPlus.results.xml file.</p>
<h2>Hands on examples on automated code coverage</h2>
Since automation is the future of QA and we have already created automated tests for both SimpleApp and SimplaAppPlus, we want to measure how our tests perform on code coverage. Automated tests run the application, attach to it and manipulate it. So it seems close to mind just to use the command from manual example and start the application with it. It will not work though since the command is starting and returning OpenCover process, not underlying SimpleAppPlus one. Extra code is needed in <a href="https://github.com/llatinov/SampleAppPlus/blob/master/SampleAppPlus.Tests.Framework/Tests/BaseTest.cs" target="_blank" rel="noopener noreferrer">SampleAppPlus.Tests.Framework\Tests\BaseTest.cs</a> file. Instead of:
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Application appWhite = Application.Launch(applicationPath);</span></span>
<span class="line"><span></span></span></code></pre>
<p>following code has to be added:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>Process sampleAppPlus = StartProcess();</span></span>
<span class="line"><span>Application appWhite = Application.Attach(sampleAppPlus);</span></span>
<span class="line"><span></span></span></code></pre>
<p>where StartProcess() method is:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>using System;</span></span>
<span class="line"><span>using System.Collections.Generic;</span></span>
<span class="line"><span>using System.Diagnostics;</span></span>
<span class="line"><span>using System.Linq;</span></span>
<span class="line"><span>using System.Threading;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>private Process StartProcess()</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>    string appName = "SampleAppPlus";</span></span>
<span class="line"><span>    string openCover = @"C:\OpenCover\OpenCover.Console.exe";</span></span>
<span class="line"><span>    long timeStamp = (long)(DateTime.UtcNow </span></span>
<span class="line"><span>                        - new DateTime(1970, 1, 1)).TotalMilliseconds;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    List&#x3C;string> arguments = new List&#x3C;string>();</span></span>
<span class="line"><span>    arguments.Add(@"-target:C:\SampleAppPlus\SampleAppPlus\bin\Debug\"</span></span>
<span class="line"><span>                    + appName + ".exe");</span></span>
<span class="line"><span>    arguments.Add(@"-output:C:\SampleAppPlus\CoverageReports\SampelAppPlus."</span></span>
<span class="line"><span>                    + timeStamp + ".xml");</span></span>
<span class="line"><span>    arguments.Add("-register:user");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Process process = new Process();</span></span>
<span class="line"><span>    process.StartInfo.FileName = openCover;</span></span>
<span class="line"><span>    process.StartInfo.Arguments = string.Join(" ", arguments);</span></span>
<span class="line"><span>    process.Start();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    Thread.Sleep(5000);</span></span>
<span class="line"><span>    return Process.GetProcesses().First(proc => appName == proc.ProcessName);</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p>OpenCover arguments “-target”, “-output” and “-register” are used. Note that -output file is always different by adding current unix time in the file name, this is to prevent overwriting of the file. The idea is to run OpenCover which will start SimpleAppPlus. Wait 5 seconds to ensure the application is up, then get all Windows processes with <strong><em>Process.GetProcesses()</em></strong>, iterate them, find and return the needed SampleAppPlus process which TestStack.White and Telerik Testing Framework will attach to.</p>
<h2>Create report</h2>
Once tests are run and OpenCover XML report files are generated it is time to generated human readable reports. This is done with ReportGenerator with the command:
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>C:\ReportGenerator\bin\ReportGenerator.exe `</span></span>
<span class="line"><span>    -reports:C:\SampleAppPlus\CoverageReports\SampelAppPlus.*.xml `</span></span>
<span class="line"><span>    -targetdir:C:\SampleAppPlus\CoverageReports\html `</span></span>
<span class="line"><span>    -sourcedirs:C:\SampleAppPlus\ `</span></span>
<span class="line"><span>    -classfilters:-SampleAppPlus.Properties.*</span></span>
<span class="line"><span></span></span></code></pre>
<p><a href="/images/2016/05/OpenCover-report.png"><img src="/images/2016/05/OpenCover-report.png" alt="OpenCover-report"></a></p>
<h2>Inspect report</h2>
Coverage report file from examples above can be found in <a href="/examples/OpenCover-report/index.htm" target="_blank" rel="noopener noreferrer">OpenCover code coverage report</a>. Inspecting the report there is missed code in SampleAppPlus.MainWindow class - else branch of <strong><em>if ((bool)openFileDialog.ShowDialog())</em></strong> condition is not covered. Documentation of this method states that it returns false if Cancel button is clicked of the dialog window. In order to increase the coverage test that clicks Cancel button and verifies no upload is done should be added to test suite.
<h2>Code coverage for IIS web application or Windows service</h2>
Examples above show how to run a normal windows application. It is valid for both UI and console applications as they are started with single EXE file. OpenCover can also work for IIS web applications, Silverlight applications and Windows service applications. More details can be found in documentation accompanying OpenCover installation.
<p>Although it is possible to connect to a running service, I have done code coverage on Windows service in the manner suggested in the documentation - run the service as a console application. Since debugging a running Windows service is not that straightforward task, developers have most likely already implemented a switch to start service as a console application. If not you will easy their lives by asking them to do so.</p>
<h2>Conclusion</h2>
OpenCover is the only open source tool for code coverage for .NET applications. It is really powerful and easy to use. No code instrumentation is needed, just build the code into Debug mode to have PDB files and run the application through OpenCover. It can also be used for <a href="https://channel9.msdn.com/coding4fun/blog/Free-Unit-Testing-Code-Coverage-with-OpenCover-and-ReportGenerator" target="_blank" rel="noopener noreferrer">measuring code coverage of unit tests</a>.  <hr data-astro-cid-bvzihdzo>  <h2 data-astro-cid-bvzihdzo>Related Posts</h2> <ul data-astro-cid-bvzihdzo> <li data-astro-cid-bvzihdzo> <a href="/what-about-code-coverage/" data-astro-cid-bvzihdzo>What about code coverage</a> </li><li data-astro-cid-bvzihdzo> <a href="/code-coverage-net-core-unit-tests-opencover/" data-astro-cid-bvzihdzo>Code coverage of .NET Core unit tests with OpenCover</a> </li> </ul>  <div class="tags" data-astro-cid-bvzihdzo> <div data-astro-cid-bvzihdzo>Tags:</div> <a href="/tags/c-sharp" data-astro-cid-bvzihdzo>C#</a><a href="/tags/code-coverage" data-astro-cid-bvzihdzo>Code coverage</a><a href="/tags/opencover" data-astro-cid-bvzihdzo>OpenCover</a><a href="/tags/tutorials" data-astro-cid-bvzihdzo>Tutorials</a> </div> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>