<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><script src="/scripts.js"></script><!-- Font preloads --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/run-dropwizard-application-docker-templated-configuration-using-environment-variables/"><!-- Primary Meta Tags --><title>Run Dropwizard application in Docker with templated configuration using environment variables</title><meta name="title" content="Run Dropwizard application in Docker with templated configuration using environment variables"><meta name="description" content="How to run Dropwizard application inside a Docker container with configuration template file which later gets replaced by environment variables."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/run-dropwizard-application-docker-templated-configuration-using-environment-variables/"><meta property="og:title" content="Run Dropwizard application in Docker with templated configuration using environment variables"><meta property="og:description" content="How to run Dropwizard application inside a Docker container with configuration template file which later gets replaced by environment variables."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/run-dropwizard-application-docker-templated-configuration-using-environment-variables/"><meta property="twitter:title" content="Run Dropwizard application in Docker with templated configuration using environment variables"><meta property="twitter:description" content="How to run Dropwizard application inside a Docker container with configuration template file which later gets replaced by environment variables."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}pre{margin:0;padding:12px}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}.tab{overflow:hidden;border:1px solid #ccc;background-color:#f1f1f1}.tab button{background-color:inherit;float:left;border:none;outline:none;cursor:pointer;padding:14px 16px;transition:.3s}.tab button:hover{background-color:#ddd}.tab button.active{background-color:#ccc}.tabcontent{display:none;border-top:none}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}.tags[data-astro-cid-bvzihdzo]{display:flex;flex-wrap:wrap}.tags[data-astro-cid-bvzihdzo]>a[data-astro-cid-bvzihdzo]{margin-left:8px}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <h1 class="post-title" data-astro-cid-bvzihdzo>Run Dropwizard application in Docker with templated configuration using environment variables</h1> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2017-04-19T00:00:00.000Z"> Apr 19, 2017 </time> </div> <hr data-astro-cid-bvzihdzo> </div>  <p>In <a href="/build-a-rest-stub-server-with-dropwizard/">Build a RESTful stub server with Dropwizard</a> post I have described how to build a Dropwizard application and run it. In the current post, I will show how this application can be inserted into Docker container and run with different configurations, based on different environment variables. Code sample here can be found as a buildable and runnable project in GitHub <a title="sample-dropwizard-rest-stub" href="https://github.com/llatinov/sample-dropwizard-rest-stub" target="_blank" rel="noopener noreferrer">sample-dropwizard-rest-stub</a> repository.</p>
<h2>Dropwizard templated config</h2>
Dropwizard supports replacing variables from config file with environment variables if such is defined. The first step is to make the config file with a special notation.
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>version: ${ENV_VARIABLE_VERSION:- 0.0.2}</span></span>
<span class="line"><span></span></span></code></pre>
<p>Dropwizard substitution is based on <a href="http://commons.apache.org/proper/commons-lang/xref/org/apache/commons/lang3/text/StrSubstitutor.html" target="_blank" rel="noopener noreferrer">Apache’s StrSubstitutor</a> library. <em><strong>${ENV_VARIABLE_VERSION:- 0.0.2}</strong></em> means that Dropwizard will search for environment variable with name <em><strong>ENV_VARIABLE_VERSION</strong></em> and replace its value with given variable. If no variable is configured then it will replace with a default value of <em><strong>0.0.2</strong></em>. If default is not needed then just <em><strong>${ENV_VARIABLE_VERSION}</strong></em> can be used.</p>
<p>Next step is to make Dropwizard substitute config file with environment variables on its startup before the file is being read. This is done with following code:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>@Override</span></span>
<span class="line"><span>public void initialize(Bootstrap&#x3C;RestStubConfig> bootstrap) {</span></span>
<span class="line"><span>    bootstrap.setConfigurationSourceProvider(new SubstitutingSourceProvider(</span></span>
<span class="line"><span>            bootstrap.getConfigurationSourceProvider(), </span></span>
<span class="line"><span>            new EnvironmentVariableSubstitutor(false)));</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span></code></pre>
<p><em><strong>EnvironmentVariableSubstitutor</strong></em> is used with <em><strong>false</strong></em> in order to suppress throwing of <em><strong>UndefinedEnvironmentVariableException</strong></em> in case environment variable is not defined. There is an approach to pack config.yml file into JAR file and use it from there, then <em><strong>bootstrap.getConfigurationSourceProvider()</strong></em> should be changed with <em><strong>path -> Thread.currentThread().getContextClassLoader().getResourceAsStream(path).</strong></em></p>
<h2>Docker</h2>
<a href="https://www.docker.com/" target="_blank" rel="noopener noreferrer">Docker</a> is a platform for building software inside containers which then can be deployed in different environments. A container is like a virtual machine with the significant difference that it does not build full operating system. In this way host's resources are optimized, container consumes as much memory as needed by the application. Virtual machine itself consumes memory to run the operating system as well. Containers have resource (CPU, RAM, HDD) isolation so that application sees the container as a separate operating system.
<h2>Dockerfile</h2>
A Dockerfile is a text document that contains all the commands a user could call on the command line to assemble an image. Using docker build users can create an automated build that executes several command-line instructions in succession. In given example Dockerfile looks like this:
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>FROM openjdk:8u121-jre-alpine</span></span>
<span class="line"><span>MAINTAINER Automation Rhapsody /</span></span>
<span class="line"><span></span></span>
<span class="line"><span>WORKDIR /var/dropwizard-rest-stub</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ADD target/sample-dropwizard-rest-stub-1.0-SNAPSHOT.jar /var/dropwizard-rest-stub/dropwizard-rest-stub.jar</span></span>
<span class="line"><span>ADD config-docker.yml /var/dropwizard-rest-stub/config.yml</span></span>
<span class="line"><span></span></span>
<span class="line"><span>EXPOSE 9000 9001</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ENTRYPOINT ["java", "-jar", "dropwizard-rest-stub.jar", "server", "config.yml"]</span></span>
<span class="line"><span></span></span></code></pre>
<p>Dockerfile starts with <em><strong>FROM openjdk:8u121-jre-alpine</strong></em> which instructs docker to use this already prepared image as a base image for the container. At <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer"></a><a href="https://hub.docker.com/">https://hub.docker.com/</a> there are numerous of images maintained by different organizations or individuals that provide different frameworks and tools. They can save you a lot of work allowing you to skip configuration and installation of general things. In given case <em><strong>openjdk:8u121-jre-alpine</strong></em> has OpenJDK JRE 1.8.121 already installed with minimalist Linux libraries. <em><strong>MAINTAINER</strong></em> documents who is the author of this file. <em><strong>WORKDIR</strong></em> sets working directory of the container. Then <em><strong>ADD</strong></em> copies JAR file and config.yml to the container. <em><strong>ENTRYPOINT</strong></em> configures the container to be run as executable. This instruction translates to <em><strong>java -jar dropwizard-rest-stub.jar server config.yml</strong></em> command. More info can be found at <a href="https://docs.docker.com/engine/reference/builder/" target="_blank" rel="noopener noreferrer">Dockerfile reference</a> link.</p>
<h2>Build Docker container</h2>
Docker container can be built with the following command:
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>docker build -t dropwizard-rest-stub .</span></span>
<span class="line"><span></span></span></code></pre>
<p><em><strong>dropwizard-rest-stub</strong></em> is the name of the container, it is later used to run container with this name. Note that dot, in the end, is mandatory.</p>
<h2>Run Docker container</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>docker run -it -p 9000:9000 -p 9001:9001 -e ENV_VARIABLE_VERSION=1.1.1 dropwizard-rest-stub</span></span>
<span class="line"><span></span></span></code></pre>
<p>The name of the container is <em><strong>dropwizard-rest-stub</strong></em> and is put in the end. With <em><strong>-p 9000:9000</strong></em> port 9000 form guest machine is exposed to host machine, otherwise the container will not be accessible. With <em><strong>-e ENV_VARIABLE_VERSION=1.1.1</strong></em> environment variable is being set. If not passed it will be substituted with <em><strong>0.0.2</strong></em> in <em><strong>config.yml</strong></em> file as described above. In the case of many environment variables, it is more comfortable to put them in a file with content <em><strong>KEY=VALUE</strong></em>. Then use this file with <em><strong>—env-file=&#x3C;PATH_TO_FILE></strong></em> instead of specifying each individual variable.</p>
<h2>Conclusion</h2>
Dropwizard has a very easy mechanism for making configuration dependant on environment variables. This makes Dropwizard applications extremely suitable to be built into Docker containers and run in different environments just by changing environment variables being passed to the container.  <hr data-astro-cid-bvzihdzo>  <h2 data-astro-cid-bvzihdzo>Related Posts</h2> <ul data-astro-cid-bvzihdzo> <li data-astro-cid-bvzihdzo> <a href="/build-a-rest-stub-server-with-dropwizard/" data-astro-cid-bvzihdzo>Build a RESTful stub server with Dropwizard</a> </li><li data-astro-cid-bvzihdzo> <a href="/build-a-rest-api-with-net-core-2-and-run-it-on-docker-linux-container/" data-astro-cid-bvzihdzo>Build a REST API with .NET Core 2 and run it on Docker Linux container</a> </li><li data-astro-cid-bvzihdzo> <a href="/build-rest-api-express-node-js-run-docker/" data-astro-cid-bvzihdzo>Build a REST API with Express on Node.js and run it on Docker</a> </li><li data-astro-cid-bvzihdzo> <a href="/run-docker-container-vagrant/" data-astro-cid-bvzihdzo>Run Docker container on Vagrant</a> </li> </ul>  <div class="tags" data-astro-cid-bvzihdzo> <div data-astro-cid-bvzihdzo>Tags:</div> <a href="/tags/docker" data-astro-cid-bvzihdzo>Docker</a><a href="/tags/dropwizard" data-astro-cid-bvzihdzo>Dropwizard</a><a href="/tags/java" data-astro-cid-bvzihdzo>Java</a><a href="/tags/tutorials" data-astro-cid-bvzihdzo>Tutorials</a> </div> </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>