<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><!-- Font preloads --><!-- <link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin /> --><!-- <link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin /> --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/aws-examples-in-c-create-a-service-working-with-dynamodb/"><!-- Primary Meta Tags --><title>AWS examples in C# - create a service working with DynamoDB</title><meta name="title" content="AWS examples in C# - create a service working with DynamoDB"><meta name="description" content="Introduction to NoSQL, introduction to DynamoDB and what are its basic features and capabilities."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/aws-examples-in-c-create-a-service-working-with-dynamodb/"><meta property="og:title" content="AWS examples in C# - create a service working with DynamoDB"><meta property="og:description" content="Introduction to NoSQL, introduction to DynamoDB and what are its basic features and capabilities."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/aws-examples-in-c-create-a-service-working-with-dynamodb/"><meta property="twitter:title" content="AWS examples in C# - create a service working with DynamoDB"><meta property="twitter:description" content="Introduction to NoSQL, introduction to DynamoDB and what are its basic features and capabilities."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder-1.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2020-03-08T00:00:00.000Z"> Mar 8, 2020 </time> <div class="last-updated-on" data-astro-cid-bvzihdzo>
Last updated on <time datetime="2022-01-18T00:00:00.000Z"> Jan 18, 2022 </time> </div> </div> <h1 class="post-title" data-astro-cid-bvzihdzo>AWS examples in C# - create a service working with DynamoDB</h1> <hr data-astro-cid-bvzihdzo> </div>  <p>This post is part of <a href="/aws-examples-in-c-working-with-sqs-dynamodb-lambda-ecs/">AWS examples in C# – working with SQS, DynamoDB, Lambda, ECS</a> series. The code used for this series of blog posts is located in <a href="https://github.com/llatinov/aws.examples.csharp" target="_blank" rel="noopener noreferrer">aws.examples.csharp</a> GitHub repository. In the current post, I give an overview of DyanmoDB and what it can be used for.</p>
<h2>NoSQL database</h2>
<a href="https://en.wikipedia.org/wiki/NoSQL" target="_blank" rel="noopener noreferrer">NoSQL</a> database provides a mechanism for storage and retrieval of data that is modeled in means other than the tabular relations used in relational databases (RDBMS). There are several types of NoSQL databases:
<ul>
 	<li><em><strong>Key-value stores</strong></em> - every single item in the database is stored as an attribute name (or 'key'), together with its value.</li>
 	<li><em><strong>Document databases</strong></em> - pair each key with a complex data structure known as a document, usually, it is a JSON document. Documents can contain many different key-value pairs, or key-array pairs, or even nested documents.</li>
 	<li><em><strong>Graph stores</strong></em> - used to store information about networks of data. Data is organized in the form of nodes and connections between the nodes.</li>
 	<li><em><strong>Wide-column stores</strong></em> - store columns of data together, instead of rows. It can query large data volumes faster than conventional relational databases.</li>
</ul>
A very good article on the NoSQL topic is <a href="https://www.mongodb.com/nosql-explained" target="_blank" rel="noopener noreferrer">NoSQL Databases Explained</a>.
<h2>AWS DynamoDB</h2>
Amazon DynamoDB is a <em><strong>key-value</strong></em> and <em><strong>document</strong></em> database that delivers single-digit millisecond performance at any scale. It's a fully managed, multi-region, multi-master, durable database with built-in security, backup and restore, and in-memory caching for internet-scale applications.
<h2>DynamoDB tables</h2>
DynamoDB stores data in tables. The data is represented as items, which have attributes. When a table is created, along with its <em><strong>name</strong></em>, a <em><strong>primary key</strong></em> should be provided. The primary key can consist only of a <em><strong>partition key</strong></em> (HASH), it is mandatory. DynamoDB uses an internal hash function to evenly distribute data items across partitions, based on their partition key values. The primary key can also consist of the <em><strong>partition key</strong></em> and <em><strong>sort key</strong></em> (RANGE), which is complementary to the partition. DynamoDB stores items with the same partition key physically close together, in sorted order by the sort key value.
<h3>Secondary indexes</h3>
DynamoDB offers the possibility to define so-called <em><strong>secondary indexes</strong></em>. There are two types - <em><strong>global</strong></em> and <em><strong>local</strong></em>. A global secondary index is a one that has a partition, a HASH, key different than the HASH key or the table, each table has a limit of 20 global indexes. A local index is one that has the same partition key but different sorting key. Up to 5 local secondary indexes per table are allowed. Properly managing those indexes is the key to using efficiently DynamoDB as a storage unit.
<h3>Streams</h3>
DynamoDB Streams is an optional feature that <em><strong>captures data modification events</strong></em> in DynamoDB tables. The data about different DynamoDB events appear in the stream in near-real-time, and in the order that the events occurred. Each event is represented by a stream record in case of add, update or delete an item. Stream records can be configured what data to hold, they can have the old and the new item, or only one of them if needed, or even only the keys. Stream records have a lifetime of 24 hours, after that, they are automatically removed from the stream. Streams are used together with <em><strong>AWS Lambda</strong></em> to create a trigger code that executes automatically whenever an event appears in a stream.
<h3>Read/Write Capacity Mode</h3>
Amazon DynamoDB has two read/write capacity modes for processing reads and writes on your tables: <em><strong>on-demand</strong></em> and <em><strong>provisioned</strong></em>, which is the default, free-tier eligible mode. The read/write capacity mode controls how charges are applied to read and write throughput and how to manage capacity. The capacity mode is set when the table is created and it can be changed later. The provisioned mode is the default one, it is recommended to be used in case of known workloads. The on-demand mode is recommended to be used in case of unpredictable and unknown workloads. DynamoDB provides <em><strong>auto-scaling</strong></em> capabilities so the table’s provisioned capacity is adjusted automatically in response to traffic changes.
<p>Understanding the concept around read and write capacity units is tricky. One <em><strong>write capacity unit</strong></em> is up to 1KB of data per second. If write is done in a transaction though, then the capacity unit count doubles. An example is if there is 2KB of data to be written per second, then the table definition needs 2 write capacity units. If the write is done in a transaction though, then 4 capacity units have to be defined. Read capacity unit is similar, with the difference that there are two flavors of reading - <em><strong>strongly consistent read</strong></em> and <em><strong>eventually consistent read</strong></em>. An eventually consistent read means, that data returned by DynamiDB might not be up to date and some write operation might not have been refracted to it. If data should be guaranteed to be propagated on all DynamoDB nodes and it is up-to-date data, then strongly consistent read is needed. One <em><strong>read capacity unit</strong></em> gives one strongly consistent read or two eventually consistent reads for data up to 4KB. Transactions double the count if read units needed, hence two units are required to read data up to 4KB. For example, if the data to be read is 8 KB, then 2 read capacity units are required to sustain one strongly consistent read per second, 1 read capacity unit if in case of eventually consistent reads, or 4 read capacity units for a transactional read request.</p>
<p>In case the application exceeds the provisioned throughput capacity on a table or index, then it is subject to <em><strong>request throttling</strong></em>. Throttling prevents the application from consuming too many capacity units. When a request is throttled, it fails with an HTTP 400 code (Bad Request) and a ProvisionedThroughputExceededException. The AWS SDKs have built-in support for retrying throttled requests, so no custom logic is needed.</p>
<h2>Different programmatic interfaces</h2>
Every AWS SDK provides one or more <em><strong>programmatic interfaces</strong></em> for working with Amazon DynamoDB. These interfaces range from simple low-level DynamoDB wrappers to object-oriented persistence layers. The available interfaces vary depending on the AWS SDK and programming language that you use. For C# available interfaces are <em><strong>low-level</strong></em> interface, <em><strong>document</strong></em> interface and <em><strong>object persistence</strong></em> interface. In <a href="/aws-examples-in-c-basic-dynamodb-operations/">AWS examples in C# – basic DynamoDB operations</a> post I have given detailed code examples of all of them.
<h2>Low-level interface</h2>
The low-level interface lets the consumer manage all the details and do the data mapping. Data is mapped manually to its proper data type. Supported data types are:
<ul>
 	<li>B - binary value, a MemoryStream</li>
 	<li>BS - list of MemoryStream objects</li>
 	<li>S - string</li>
 	<li>SS - list of string objects</li>
 	<li>N - number converted into a string</li>
 	<li>NS - list of number strings</li>
 	<li>BOOL - boolean</li>
 	<li>L - list of AttributeValue objects</li>
 	<li>M - map, dictionary of AttributeValue objects</li>
 	<li>NULL - if set to true, then this is a null value</li>
</ul>
If the low-level interface is used for querying then a <em><strong>KeyConditionExpression</strong></em> is used to query the data. It is called a query, but it not actually a query in terms of RDBMS way of thinking, as the HASH key should be only used with an equality operator. For the RANGE key, there is a variety of operators to be used, such as:
<ul>
 	<li>sortKeyName = :sortkeyval - true if the sort key value is equal to :sortkeyval</li>
 	<li>sortKeyName &#x3C; :sortkeyval - true if the sort key value is less than :sortkeyval</li>
 	<li>sortKeyName &#x3C;= :sortkeyval - true if the sort key value is less than or equal to :sortkeyval</li>
 	<li>sortKeyName > :sortkeyval - true if the sort key value is greater than :sortkeyval</li>
 	<li>sortKeyName >= :sortkeyval - true if the sort key value is greater than or equal to :sortkeyval</li>
 	<li>sortKeyName BETWEEN :sortkeyval1 AND :sortkeyval2 - true if the sort key value is greater than or equal to :sortkeyval1, and less than or equal to :sortkeyval2</li>
 	<li>begins_with ( sortKeyName, :sortkeyval ) - true if the sort key value begins with a particular operand. (You cannot use this function with a sort key that is of type Number.) Note that the function name begins_with is case-sensitive.</li>
</ul>
<h2>Document interface</h2>
The document programming interface returns the full document by its unique HASH key. The document is actually a JSON.
<pre class="language-csharp"><code>{
	"Title": {
		"Value": "Die Hard",
		"Type": 0
	},
	"Genre": {
		"Value": "0",
		"Type": 1
	}
}</code></pre>
<h2>Object persistence interface</h2>
WIth object persistency client classes are mapped to DynamoDB tables. There are several <em><strong>attributes</strong></em> that can be applied to <em><strong>database model classes</strong></em>, such as  DynamoDBTable, DynamoDBHashKey, DynamoDBRangeKey, DynamoDBProperty, DynamoDBIgnore, etc. To save the client-side objects to the tables, the object persistence model provides the <em><strong>DynamoDBContext</strong></em> class, an entry point to DynamoDB. This class provides a connection to DynamoDB and enables you to access tables, perform various <em><strong>CRUD</strong></em> operations.
<h2>Architectural constraints</h2>
Understanding DynamoDB nature is important in order to design a service that works with it. It is important to cost-efficiently define the table capacity. If less capacity is defined, then consumers can get 400 responses, the other extreme is to generate way too much cost. Another aspect is reading the data. DynamoDB does not provide a way to search for data. In any case, the application that used DynamoDB has to have a proper way to access the data by key.
<h2>Using DynamoDB in a service</h2>
DynamoDB can be straight forward used in a service, such as SqsReader or ActorsServerlessLambda and MoviesServerlessLambda functions, see the bigger picture in <a href="/aws-examples-in-c-working-with-sqs-dynamodb-lambda-ecs/">AWS examples in C# – working with SQS, DynamoDB, Lambda, ECS</a> post. An <em><strong>AmazonDynamoDBClient</strong></em> is instantiated and used with one of the programming interfaces described above.
<p>Another important usage is to subscribe to and process stream events. This is done in both ActorsLambdaFunction and MoviessLambdaFunction. See more details about Lambda usage in <a href="/aws-examples-in-c-working-with-lambda-functions/">AWS examples in C# – working with Lambda functions</a> post.</p>
<p><span>More information on how to run the solution can be found in </span><a href="/aws-examples-in-c-run-the-solution/">AWS examples in C# – run the solution</a><span> post.</span></p>
<h2>Conclusion</h2>
In the current post, I have given a basic overview of DynamoDB. It is important to understand its specifics in order to use it efficiently.  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>