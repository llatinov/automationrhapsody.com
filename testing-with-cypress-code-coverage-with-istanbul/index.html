<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="Automation Rhapsody" href="https://automationrhapsody.com/rss.xml"><meta name="generator" content="Astro v5.5.3"><!-- Font preloads --><!-- <link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin /> --><!-- <link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin /> --><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Playball"><link rel="stylesheet" property="stylesheet" href="https://fonts.googleapis.com/css?family=Bitter:400,400italic,700"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet"><!-- Canonical URL --><link rel="canonical" href="https://automationrhapsody.com/testing-with-cypress-code-coverage-with-istanbul/"><!-- Primary Meta Tags --><title>Testing with Cypress - Code coverage with Istanbul</title><meta name="title" content="Testing with Cypress - Code coverage with Istanbul"><meta name="description" content="This article describes how to extract and process Istanbul code coverage, and generate HTML reports."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://automationrhapsody.com/testing-with-cypress-code-coverage-with-istanbul/"><meta property="og:title" content="Testing with Cypress - Code coverage with Istanbul"><meta property="og:description" content="This article describes how to extract and process Istanbul code coverage, and generate HTML reports."><meta property="og:image" content="https://automationrhapsody.com/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://automationrhapsody.com/testing-with-cypress-code-coverage-with-istanbul/"><meta property="twitter:title" content="Testing with Cypress - Code coverage with Istanbul"><meta property="twitter:description" content="This article describes how to extract and process Istanbul code coverage, and generate HTML reports."><meta property="twitter:image" content="https://automationrhapsody.com/blog-placeholder-1.jpg"><style>:root{--color-gray-bg: #f5f5f5;--color-gray-text: #5e5e5e}body{font-family:Roboto,sans-serif;background:var(--color-gray-bg);word-wrap:break-word;overflow-wrap:break-word;color:var(--color-gray-text);font-size:18px}main{width:960px;max-width:calc(100% - 2em);margin:auto}h2{color:#3879d9;font-size:20px;margin:25px 0 6px}p{margin:6px 0}img{max-width:100%}@media (max-width: 720px){body{font-size:16px}ul{padding-inline-start:16px}}footer[data-astro-cid-sz7xmlte]{margin:24px 0;text-align:center}header[data-astro-cid-3ef6ksr2]{text-align:center;font-size:56px}header[data-astro-cid-3ef6ksr2] div[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{font-family:Playball,Arial;color:#000;text-decoration:none;text-shadow:0 .033em 0 #fff;border-bottom:none}
article[data-astro-cid-bvzihdzo]{padding:24px;box-shadow:0 2px 3px #acabab;background:#fff;position:relative}.post-title[data-astro-cid-bvzihdzo]{font-family:Bitter,serif;font-weight:700!important;margin:0;padding:5px 0;font-size:32px;line-height:40px;color:#444}@media (max-width: 720px){article[data-astro-cid-bvzihdzo]{padding:12px}}
</style></head> <body data-astro-cid-bvzihdzo> <header data-astro-cid-3ef6ksr2> <div data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Automation Rhapsody</a> </div> </header>  <main data-astro-cid-bvzihdzo> <article data-astro-cid-bvzihdzo> <div class="prose" data-astro-cid-bvzihdzo> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2019-06-30T00:00:00.000Z"> Jun 30, 2019 </time> <div class="last-updated-on" data-astro-cid-bvzihdzo>
Last updated on <time datetime="2022-01-18T00:00:00.000Z"> Jan 18, 2022 </time> </div> </div> <h1 class="post-title" data-astro-cid-bvzihdzo>Testing with Cypress - Code coverage with Istanbul</h1> <hr data-astro-cid-bvzihdzo> </div>  <p>This post is part of a Cypress series, you can see all post from the series in <a href="/testing-with-cypress-lessons-learned-in-a-complete-framework/">Testing with Cypress - lessons learned in a complete framework</a>. Examples code is located <span>in </span><a href="https://github.com/llatinov/cypress-testing-framework" target="_blank" rel="noopener noreferrer">cypress-testing-framework</a><span> GitHub repository.</span></p>
<h2>Code coverage instrumentation</h2>
In <a href="/testing-with-cypress-build-a-react-application-with-node-js-backend/">Testing with Cypress - Build a React application with Node.js backend</a> is described how the application is instrumented to track code coverage. This is a very essential part, without it, measurement is not possible.
<h2>Code coverage capturing data</h2>
Capturing of code coverage results is done in <em><strong>cypress/support/core/cypress_code_coverage.js</strong></em> file. It is included in <em><strong>cypress/support/index.js</strong></em> file with <em><strong>import './core/cypress_code_coverage';</strong></em> statement. For each and every test suite separate file with coverage data is created. Depending on the application those files can get pretty big, and writing and reading them slows the tests. So code coverage is controlled with <em><strong>TEST_CODE_COVERAGE</strong></em> environment variable. By default, it is set to <em><strong>false</strong></em>. Once all tests are run and coverage data is saved then it has to be merged. Merging is invoked with <strong><em>yarn</em> cypress:report</strong> command.
<h2>Code coverage report</h2>
An important prerequisite is to generate the code coverage report is to have <a href="https://www.npmjs.com/package/nyc" target="_blank" rel="noopener noreferrer">nyc</a> installed as a global NPM package. Since the paths in the container are not the same as the paths locally, in order to read correct sources there is reprocessing of the paths, <em><strong>DOCKER_CONTAINER_PATH</strong></em> is replaced with the current folder. You can see how code coverage looks like in <a href="/examples/Istanbul-report/index.html" target="_blank" rel="noopener noreferrer">Istanbul-report</a>. For this particular example only <em><strong>save_person_spec.js</strong></em> has been run with <em><strong>yarn cypress:run --spec='cypress/tests/persons/save_person_spec.js'</strong></em> command.
<p><a href="/images/2019/06/Cypress-code-coverage-main.png"><img src="/images/2019/06/Cypress-code-coverage-main.png"></a></p>
<p><a href="/images/2019/06/Cypress-code-coverage-folder.png"><img src="/images/2019/06/Cypress-code-coverage-folder.png"></a></p>
<p><a href="/images/2019/06/Cypress-code-coverage-class.png"><img src="/images/2019/06/Cypress-code-coverage-class.png"></a></p>
<h2>Conclusion</h2>
Code coverage is not a crucial part of the whole QA process but is very nice to have feature. With code coverage, we can improve on our tests, make them cover bits of the code that we have missed during analysis and creating of the tests themselves.  </div> </article> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2025 - Automation Rhapsody. All rights reserved.
</footer>  </body></html>